<div>
  <div>Contexts</div>
  
    
    <div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          request_status_and_confirm site, "input status",
            { S0003: [:inputstatus,:extendedinputstatus] }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          request_status_and_confirm site, "input status",
            { S0003: [:inputstatus] }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          request_status_and_confirm site, "forced input status",
            { S0029: [:status] }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          inputs = Validator.get_config('items','inputs')
          skip("No inputs configured") if inputs.nil? || inputs.empty?
          inputs.each do |input|
            force_input input: input, status: 'True', value: 'False'
            force_input input: input, status: 'True', value: 'True'
          ensure
            force_input input: input, status: 'False', validate: false
          end
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          inputs = Validator.get_config('items','inputs')
          skip("No inputs configured") if inputs.nil? || inputs.empty?
          prepare task, site
          inputs.each { |input| switch_input input }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          inputs = Validator.get_config('items','inputs')
          skip("No inputs configured") if inputs.nil? || inputs.empty?
          status = "1,3,12;5,5,10"
          set_series_of_inputs status
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          status = '1-50'
          set_trigger_level status
        end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          request_status_and_confirm site, "output status",
            { S0004: [:outputstatus] }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          request_status_and_confirm site, "output status",
            { S0004: [:outputstatus] }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          request_status_and_confirm site, "forced output status",
            { S0030: [:status] }
        end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
          prepare task, site
          outputs = Validator.get_config('items','outputs')
          skip("No outputs configured") if outputs.nil? || outputs.empty?
          outputs.each do |output|
            force_output output: output, status:'True', value:'True'
            force_output output: output, status:'True', value:'False'
          ensure
            force_output output: output, status:'False', validate: false
          end
       end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        alarm_code_id = 'A0302'
        prepare task, site
        def verify_timestamp alarm, duration=1.minute
          alarm_time = Time.parse(alarm.attributes["aTs"])
          expect(alarm_time).to be_within(duration).of Time.now.utc
        end
        deactivated, component_id = with_alarm_activated(task, site, alarm_code_id) do |alarm,component_id|   # raise alarm, by activating input
          verify_timestamp alarm
          log "Alarm #{alarm_code_id} is now Active on component #{component_id}"
        end
        verify_timestamp deactivated
        log "Alarm #{alarm_code_id} is now Inactive on component #{component_id}"
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        alarm_code_id = 'A0302'   # what alarm to expect
        timeout  = Validator.get_config('timeouts','alarm')

        log "Activating alarm #{alarm_code_id}"
        deactivate, component_id = with_alarm_activated(task, site, alarm_code_id) do |alarm, component_id|   # raise alarm, by activating input
          log "Alarm #{alarm_code_id} is now active on component #{component_id}"

          # verify timestamp
          alarm_time = Time.parse(alarm.attributes["aTs"])
          expect(alarm_time).to be_within(1.minute).of Time.now.utc

          # test acknowledge and confirm
          log "Acknowledge alarm #{alarm_code_id}"

          collect_task = task.async do
            RSMP::AlarmCollector.new(site,
              num: 1,
              matcher: {
                'aCId' => alarm_code_id,
                'aSp' => /Acknowledge/i,
                'ack' => /Acknowledged/i,
                'aS' => /Active/i
              },
              timeout: timeout
            ).collect!
          end

          site.send_message RSMP::AlarmAcknowledge.new(
            'cId' => component_id,
            'aTs' => site.clock.to_s,
            'aCId' => alarm_code_id
          )
          messages = collect_task.wait
          expect(messages).to be_an(Array)
          expect(messages.first).to be_a(RSMP::Alarm)
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        alarm_code_id = 'A0302'
        input, component_id = find_alarm_programming(alarm_code_id)

        # first resume alarm to make sure something happens when we suspend
        resume_alarm site, task, cId: component_id, aCId: alarm_code_id, collect: false

        begin
          # suspend alarm
          request, response = suspend_alarm site, task, cId: component_id, aCId: alarm_code_id, collect: true
          expect(response).to be_a(RSMP::AlarmSuspended)

          # resume alarm
          request, response = resume_alarm site, task, cId: component_id, aCId: alarm_code_id, collect: true
          expect(response).to be_a(RSMP::AlarmResumed)
        ensure
          # always end with resuming alarm
          resume_alarm site, task, cId: component_id, aCId: alarm_code_id, collect: false
        end
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "current date and time",
          { S0096: [
            :year,
            :month,
            :day,
            :hour,
            :minute,
            :second,
          ] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        set_clock(CLOCK)
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do
            status_list = { S0096: [
              :year,
              :month,
              :day,
              :hour,
              :minute,
              :second,
            ] }
            result = site.request_status Validator.get_config('main_component'), convert_status_list(status_list), collect!: {
              timeout: Validator.get_config('timeouts','status_update')
            }
            collector = result[:collector]
            status = status_list.keys.first.to_s

            received = Time.new(
              collector.matcher_result( {"sCI" => status, "n" => "year"} )['s'],
              collector.matcher_result( {"sCI" => status, "n" => "month"} )['s'],
              collector.matcher_result( {"sCI" => status, "n" => "day"} )['s'],
              collector.matcher_result( {"sCI" => status, "n" => "hour"} )['s'],
              collector.matcher_result( {"sCI" => status, "n" => "minute"} )['s'],
              collector.matcher_result( {"sCI" => status, "n" => "second"} )['s'],
              'UTC'
            )

            max_diff =
              Validator.get_config('timeouts','command_response') +
              Validator.get_config('timeouts','status_response')

            diff = received - CLOCK
            diff = diff.round
            expect(diff.abs).to be <= max_diff,
              "Clock reported by S0096 is off by #{diff}s, should be within #{max_diff}s"
          end
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do
            status_list = { S0096: [
              :year,
              :month,
              :day,
              :hour,
              :minute,
              :second,
            ] }

            result = site.request_status Validator.get_config('main_component'),
              convert_status_list(status_list),
              collect!: {
                timeout: Validator.get_config('timeouts','status_response')
              }
            collector = result[:collector]

            max_diff = Validator.get_config('timeouts','command_response') + Validator.get_config('timeouts','status_response')
            diff = Time.parse(collector.messages.first.attributes['sTs']) - CLOCK
            diff = diff.round
            expect(diff.abs).to be <= max_diff,
              "Timestamp of S0096 is off by #{diff}s, should be within #{max_diff}s"
          end
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do
            result = site.request_aggregated_status Validator.get_config('main_component'), collect!: {
              timeout: Validator.get_config('timeouts','status_response')
            }
            collector = result[:collector]
            max_diff = Validator.get_config('timeouts','command_response') + Validator.get_config('timeouts','status_response')
            diff = Time.parse(collector.messages.first.attributes['aSTS']) - CLOCK
            diff = diff.round
            expect(diff.abs).to be <= max_diff,
              "Timestamp of aggregated status is off by #{diff}s, should be within #{max_diff}s"
          end
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do
            result = set_functional_position 'NormalControl'
            collector = result[:collector]
            max_diff = Validator.get_config('timeouts','command_response') * 2
            diff = Time.parse(collector.messages.first.attributes['cTS']) - CLOCK
            diff = diff.round
            expect(diff.abs).to be <= max_diff,
              "Timestamp of command response is off by #{diff}s, should be within #{max_diff}s"
          end
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do
            result = set_functional_position 'NormalControl'
            collector = result[:collector]
            max_diff = Validator.get_config('timeouts','command_response')
            diff = Time.parse(collector.messages.first.attributes['cTS']) - CLOCK
            diff = diff.round
            expect(diff.abs).to be <= max_diff,
              "Timestamp of command response is off by #{diff}s, should be within #{max_diff}s"
          end
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do                           # set clock
            with_alarm_activated(task, site, 'A0302') do |alarm|   # raise alarm, by activating input
              alarm_time = Time.parse( alarm.attributes["aTs"] )
              max_diff = Validator.get_config('timeouts','command_response') + Validator.get_config('timeouts','status_response')
              diff = alarm_time - CLOCK
              expect(diff.round.abs).to be <= max_diff,
                "Timestamp of alarm is off by #{diff}s, should be within #{max_diff}s"
            end
          end
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        site.with_watchdog_disabled do  # avoid time synchronization by disabling watchdogs
          with_clock_set site, CLOCK do
            log "Checking watchdog timestamp"
            collector = RSMP::Collector.new site, task:task, type: "Watchdog", num: 1, timeout: Validator.get_config('timeouts','watchdog')
            collector.collect!
            max_diff = Validator.get_config('timeouts','command_response') + Validator.get_config('timeouts','status_response')
            diff = Time.parse(collector.messages.first.attributes['wTs']) - CLOCK
            diff = diff.round
            expect(diff.abs).to be <= max_diff,
              "Timestamp of watchdog is off by #{diff}s, should be within #{max_diff}s"
          end
        end
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "control mode",
          { S0020: [:controlmode,:intersection] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic controller starting (true/false)",
          { S0005: [:statusByIntersection] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic controller starting (true/false)",
          { S0005: [:statusByIntersection] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        status_list = { S0007: [:status,:intersection,:source] }
        request_status_and_confirm site, "controller switch on (dark mode=off)", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        status_list = { S0007: [:status,:intersection,:source] }
        request_status_and_confirm site, "controller switch on (dark mode=off)", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0008: [:status,:intersection,:source] }
        else
          status_list = { S0008: [:status,:intersection] }
        end
        request_status_and_confirm site, "manual control status", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0009: [:status,:intersection,:source] }
        else
          status_list = { S0009: [:status,:intersection] }
        end
        request_status_and_confirm site, "fixed time control status", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        switch_fixed_time 'True'
        switch_fixed_time 'False'
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0010: [:status,:intersection,:source] }
        else
          status_list = { S0010: [:status,:intersection] }
        end
        request_status_and_confirm site, "isolated control status", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        status_list = { S0032: [:status,:intersection,:source] }
        request_status_and_confirm site, "coordinated control status", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0011: [:status,:intersection,:source] }
        else
          status_list = { S0011: [:status,:intersection] }
        end
        request_status_and_confirm site, "yellow flash status", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        switch_yellow_flash
        switch_normal_control
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        timeout =  Validator.get_config('timeouts','yellow_flash')

        switch_yellow_flash
        wait_for_groups 'c', timeout: timeout      # c mean s yellow flash

        switch_normal_control
        wait_for_groups '[^c]', timeout: timeout   # not c, ie. not yellow flash
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0012: [:status,:intersection,:source] }
        else
          status_list = { S0012: [:status,:intersection] }
        end
        request_status_and_confirm site, "all-red status", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "police key",
          { S0013: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        switch_dark_mode
        switch_normal_control
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        switch_normal_control
        minutes = 1
        switch_yellow_flash timeout_minutes: minutes
        wait_normal_control timeout: minutes*60 + Validator.get_config('timeouts','functional_position')
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0091: [:user] }
        else
          status_list = { S0091: [:user, :status] }
        end
        request_status_and_confirm site, "operator logged in/out OP-panel", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0092: [:user] }
        else
          status_list = { S0092: [:user, :status] }
        end
        request_status_and_confirm site, "operator logged in/out web-interface", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "version of traffic controller",
        { S0095: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        set_security_code 1
        set_security_code 2
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        expect { wrong_security_code }.to raise_error(RSMP::MessageRejected)
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        log "Subscribe to status and wait for update"
        component = Validator.get_config('main_component')

        status_list = [{'sCI'=>'S0001','n'=>'signalgroupstatus','uRt'=>'1'}]
        status_list.map! { |item| item.merge!('sOc' => true) } if use_sOc?(site)

         site.subscribe_to_status component, status_list, collect!: {
          timeout: Validator.get_config('timeouts','status_update')
        }
      ensure
        unsubscribe_list = status_list.map { |item| item.slice('sCI','n') }
        site.unsubscribe_to_status component, unsubscribe_list
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0014: [:status,:source] }
        else
          status_list = { S0014: [:status] }
        end
        request_status_and_confirm site, "current time plan", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>plans = Validator.get_config('items','plans')
      skip("No time plans configured") if plans.nil? || plans.empty?
      Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        plans.each { |plan| switch_plan plan }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "number of time plans",
          { S0018: [:number] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "list of time plans",
          { S0022: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "week time table",
          { S0026: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        status = "0-1,6-2"
        prepare task, site
        set_week_table status
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "command table",
          { S0027: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        status = "12-1-12-59,1-0-23-12"
        prepare task, site
        set_day_table status
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "version of traffic program",
          { S0097: [:timestamp,:checksum] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        result = request_status_and_confirm site, "config of traffic parameters",
          { S0098: [:timestamp,:config,:version] }

        # the site  should have stored the received status
        message = result[:collector].messages.first
        expect(message).to be_an(RSMP::StatusResponse)
        values = message.attributes['sS'].map { |item| [item['n'], item['s']] }.to_h

        expect(values['timestamp']).not_to be_empty
        expect(values['config']).not_to be_empty
        expect(values['timestamp']).not_to be_empty
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "command table",
          { S0023: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        plan = Validator.get_config('items','plans').first
        status = "1-12"
        prepare task, site
        set_dynamic_bands plan, status
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        plan = Validator.get_config('items','plans').first
        band = 3

        value = get_dynamic_bands(plan, band) || 0
        expect( value ).to be_a(Integer)

        new_value = value + 1
        
        set_dynamic_bands plan, "#{band}-#{new_value}"
        expect( get_dynamic_bands(plan, band) ).to eq(new_value)

        set_dynamic_bands plan, "#{band}-#{value}"
        expect( get_dynamic_bands(plan, band) ).to eq(value)
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        status = 10
        set_timeout_for_dynamic_bands status
        status = 0
        set_timeout_for_dynamic_bands status
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "offset time",
          { S0024: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        plan = Validator.get_config('items','plans').first
        status = 99
        prepare task, site
        set_offset status, plan
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "cycle time",
          { S0028: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        with_cycle_time_extended(site) do
          log "Cycle time extension confirmed"
        end
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: number of vehicles",
          { S0201: [:starttime,:vehicles] },
          Validator.get_config('components','detector_logic').keys.first
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: number of vehicles",
          { S0205: [:start,:vehicles] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: vehicle speed",
          { S0202: [:starttime,:speed] },
          Validator.get_config('components','detector_logic').keys.first
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: vehicle speed",
          { S0206: [:start,:speed] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: occupancy",
          { S0203: [:starttime,:occupancy] },
          Validator.get_config('components','detector_logic').keys.first
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: occupancy",
          { S0207: [:start,:occupancy] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: classification",
          { S0204: [
              :starttime,
              :P,
              :PS,
              :L,
              :LS,
              :B,
              :SP,
              :MC,
              :C,
              :F
          ] },
          Validator.get_config('components','detector_logic').keys.first
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "traffic counting: classification",
          { S0208: [
              :start,
              :P,
              :PS,
              :L,
              :LS,
              :B,
              :SP,
              :MC,
              :C,
              :F
          ] }
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        set_signal_start
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        set_signal_stop
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "signal group status",
          { S0001: [:signalgroupstatus, :cyclecounter, :basecyclecounter, :stage] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "time-of-green/time-of-red",
          { S0025: [
              :minToGEstimate,
              :maxToGEstimate,
              :likelyToGEstimate,
              :ToGConfidence,
              :minToREstimate,
              :maxToREstimate,
              :likelyToREstimate
          ] },
          Validator.get_config('components','signal_group').keys.first
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "number of signal groups",
          { S0017: [:number] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        verify_startup_sequence do
          switch_yellow_flash
          set_functional_position 'NormalControl'
        end
        set_functional_position 'NormalControl'
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "number of detector logics",
          { S0016: [:number] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "detector logic status",
          { S0002: [:detectorlogicstatus] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "detector logic forcing",
          { S0021: [:detectorlogics] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site

        Validator.get_config('components','detector_logic').keys.each_with_index do |component, indx|
          force_detector_logic component, mode:'True'
          wait_for_status(@task,
            "detector logic #{component} to be True",
            [{'sCI'=>'S0002','n'=>'detectorlogicstatus','s'=>/^.{#{indx}}1/}]
          )
          
          force_detector_logic component, mode:'False'
          wait_for_status(@task,
            "detector logic #{component} to be False",
            [{'sCI'=>'S0002','n'=>'detectorlogicstatus','s'=>/^.{#{indx}}0/}]
          )
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "loop detector sensitivity",
          { S0031: [:status] }
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        signal_group = Validator.get_config('components','signal_group').keys.first
        command_list = build_command_list :M0022, :requestPriority, {
          requestId: SecureRandom.uuid()[0..3],
          signalGroupId: signal_group,
          type: 'new',
          level: 7,
          eta: 10,
          vehicleType: 'car'
        }
        prepare task, site
        send_command_and_confirm @task, command_list,
          "Request signal priority for signal group #{signal_group}"
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "signal group status",
          { S0033: [:status] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        status_list = [{'sCI'=>'S0033','n'=>'status','uRt'=>'0'}]
        status_list.map! { |item| item.merge!('sOc' => true) } if use_sOc?(site)
        wait_for_status task, 'signal priority status', status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        timeout = Validator.get_config('timeouts','priority_completion')
        component = Validator.get_config('main_component')
        signal_group_id = Validator.get_config('components','signal_group').keys.first
        prio = Validator::StatusHelpers::SignalPriorityRequestHelper.new(
          site,
          component: component,
          signal_group_id: signal_group_id,
          timeout: timeout,
          task: task
        )

        prio.run do
          log "Before: Send unrelated signal priority request."
          prio.request_unrelated

          log "Send signal priority request, wait for reception."
          prio.request

          log "After: Send unrelated signal priority request."
          prio.request_unrelated

          prio.expect :received
          log "Signal priority request was received, wait for activation."

          prio.expect :activated
          log "Signal priority request was activated, now cancel it and wait for completion."


          prio.cancel
          prio.expect :completed
          log "Signal priority request was completed."
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        timeout = Validator.get_config('timeouts','priority_completion')
        component = Validator.get_config('main_component')
        signal_group_id = Validator.get_config('components','signal_group').keys.first
        prio = Validator::StatusHelpers::SignalPriorityRequestHelper.new(
          site,
          component: component,
          signal_group_id: signal_group_id,
          timeout: timeout,
          task: task
        )

        prio.run do
          log "Before: Send unrelated signal priority request."
          prio.request_unrelated

          log "Send signal priority request, wait for reception."
          prio.request

          log "After: Send unrelated signal priority request."
          prio.request_unrelated

          prio.expect :received
          log "Signal priority request was received, wait for activation."

          prio.expect :activated
          log "Signal priority request was activated, wait for it to become stale."


          # don't cancel request, it should then become stale by itself
          prio.expect :stale
          log "Signal priority request became stale."
        end
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "emergency route status",
          { S0006: [:status,:emergencystage] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "emergency route status",
          { S0035: [:emergencyroutes] }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>emergency_routes = Validator.get_config('items','emergency_routes')
      skip("No emergency routes configured") if emergency_routes.nil? || emergency_routes.empty?

      def set_emergency_states task, emergency_routes, state
        emergency_routes.each do |emergency_route|
          set_emergency_route emergency_route.to_s, state
        end
        wait_for_status(task, "emergency route #{emergency_routes.last} to be enabled",
          [
            {'sCI'=>'S0006','n'=>'status','s'=>(state ? 'True' : 'False')},
            {'sCI'=>'S0006','n'=>'emergencystage','s'=>(state ? emergency_routes.last.to_s : '0')}
          ]
        )
     end

      Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        set_emergency_states task, emergency_routes, false
        begin
          set_emergency_states task, emergency_routes, true
        ensure
          set_emergency_states task, emergency_routes, false
        end
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>def enable_routes task, emergency_routes
        emergency_routes.each { |emergency_route| set_emergency_route emergency_route.to_s, true }
        routes = emergency_routes.map {|i| {'id'=>i.to_s} }
        wait_for_status(task, "emergency routes #{emergency_routes.to_s} to be enabled",
          [ {'sCI'=>'S0035','n'=>'emergencyroutes','s'=>routes} ]
        )
      end

      def disable_routes task, emergency_routes
        emergency_routes.each { |emergency_route| set_emergency_route emergency_route.to_s, false }
        routes = []
        wait_for_status(task, "all emergency routes to be disabled",
          [ {'sCI'=>'S0035','n'=>'emergencyroutes','s'=>routes} ]
        )
      end

      emergency_routes = Validator.get_config('items','emergency_routes')

      skip("No emergency routes configured") if emergency_routes.nil? || emergency_routes.empty?

      Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        disable_routes task, emergency_routes
        begin
          enable_routes task, emergency_routes
        ensure
          disable_routes task, emergency_routes
        end
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        if RSMP::Proxy.version_meets_requirement?( site.sxl_version, '>=1.1' )
          status_list = { S0015: [:status,:source] }
        else
          status_list = { S0015: [:status] }
        end
        request_status_and_confirm site, "current traffic situation", status_list
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>situations = Validator.get_config('items','traffic_situations')
      skip("No traffic situations configured") if situations.nil? || situations.empty?
      Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        situations.each { |traffic_situation| switch_traffic_situation traffic_situation.to_s }
      ensure
        unset_traffic_situation
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        request_status_and_confirm site, "number of traffic situations",
          { S0019: [:number] }
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.1'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.2'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.3'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.4'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.5'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.2'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.2.1'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.2.2'</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>timeout = Validator.get_config('timeouts','disconnect')
      Validator::Site.isolated do |task,supervisor,site_proxy|
        supervisor.ignore_errors RSMP::DisconnectError do
          log "Disabling watchdog acknowledgements, site should disconnect"
          def site_proxy.acknowledge original
            if original.is_a? RSMP::Watchdog
              log "Not acknowledgning watchdog", message: original
            else
              super
            end
          end
          site_proxy.wait_for_state :disconnected, timeout: timeout
        end
      rescue RSMP::TimeoutError
        raise "Site did not disconnect within #{timeout}s"
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.isolated do |task,supervisor,site|
        timeout = Validator.get_config('timeouts','disconnect')

        wait_task = task.async do
          site.wait_for_state :disconnected, timeout: timeout
          raise RSMP::DisconnectError
        rescue RSMP::TimeoutError
          # ok, no disconnect happened
        end

        log "Stop sending watchdogs, site should not disconnect"
        site.with_watchdog_disabled do
          wait_task.wait
        end
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.connected do |task,supervisor,site|
        prepare task, site
        log "Request aggregated status"
        result = site.request_aggregated_status Validator.get_config('main_component'), collect!: {
          timeout: Validator.get_config('timeouts','status_response')
        }
      end</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Site.isolated(
        'collect' => {
          filter: RSMP::Filter.new(type:"AggregatedStatus"),
          timeout: Validator.get_config('timeouts','ready'),
          num: 1,
          ingoing: true
        }
      ) do |task,supervisor,site_proxy|
        collector = site_proxy.collector
        collector.use_task task
        collector.wait!
        aggregated_status = site_proxy.collector.messages.first

        expect(aggregated_status).to be_an(RSMP::AggregatedStatus)
        expect(aggregated_status.attribute('fP')).to be_nil
        expect(aggregated_status.attribute('fS')).to be_nil
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
  </ul>
</div></li>
    
    
    
  
  </ul>
</div>
  
    
    <div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
    
    
    <li class='odd'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.1'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.2'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.3'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.4'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.1.5'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.2'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.2.1'</div> -->
</div></li>
      
      
    
      
      <li class='context-specification even'><div>
  <div class="specification">
    
  </div>
  <!-- <div>check_sequence '3.2.2'</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
    
    
    <li class='even'><div class='context'>
  <div class='title'></div>
  
  
  <ul class='context-specifications'>
    
      
      <li class='context-specification odd'><div>
  <div class="specification">
    
  </div>
  <!-- <div>Validator::Supervisor.connected do |task,site,supervisor_proxy|
        component = site.find_component Validator.get_config('main_component')

        # setting ':collect' will cause set_aggregated_status() to wait for the
        # outgoing aggregated status is acknowledged
        component.set_aggregated_status :high_priority_alarm, collect!: {
          timeout: Validator.get_config('timeouts','acknowledgement'),
          num: 1
        }
      end</div> -->
</div></li>
      
      
    
  </ul>
  
  <ul class='context-subcontext'>
  
  </ul>
</div></li>
    
    
    
  
  </ul>
</div>
  
</div>