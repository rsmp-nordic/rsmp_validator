<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Context: Specifications::Site::Traffic Light Controller
  
    &mdash; Documentation by YARD 0.9.37
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

  <link rel="stylesheet" href="../../css/rspec.css" type="text/css" />

<script type="text/javascript">
  pathId = "Specifications::Site::Traffic Light Controller";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Specifications.html" title="Specifications (rspec)">Specifications</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Site.html" title="Specifications::Site (context)">Site</a></span></span>
     &raquo; 
    <span class="title">Traffic Light Controller</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div class='context'>
  <h1 class='title'>
  
    Specifications: 
  

  </h1>

  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
     &raquo; 
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-14"></a>
    Traffic Light Controller IO Input is read with S0003 with extended input status
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can read input status with S0003, extendedinputstatus attribute</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we read input with S0029</p>
</li><li>
<p>Then we should receive a valid response</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


14
15
16
17</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 14</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>input status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbrace'>{</span> <span class='label'>S0003:</span> <span class='lbracket'>[</span><span class='symbol'>:inputstatus</span><span class='comma'>,</span><span class='symbol'>:extendedinputstatus</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-25"></a>
    Traffic Light Controller IO Input is read with S0003
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can read input status with S0003</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we read input with S0029</p>
</li><li>
<p>Then we should receive a valid response</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


25
26
27
28</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 25</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>input status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbrace'>{</span> <span class='label'>S0003:</span> <span class='lbracket'>[</span><span class='symbol'>:inputstatus</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-36"></a>
    Traffic Light Controller IO Input forcing is read with S0029
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can read forced input status with S0029</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we read input with S0029</p>
</li><li>
<p>Then we should receive a valid response</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


36
37
38
39</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 36</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>forced input status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbrace'>{</span> <span class='label'>S0029:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-49"></a>
    Traffic Light Controller IO Input forcing is set with M0019
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can force input with M0019</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And the input is forced off</p>
</li><li>
<p>When we force the input on</p>
</li><li>
<p>Then S0003 should show the input on</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


49
50
51
52
53
54
55
56
57
58
59</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 49</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inputs</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No inputs configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_input'>input</span><span class='op'>|</span>
            <span class='id identifier rubyid_force_input'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_input-instance_method" title="Validator::CommandHelpers#force_input (method)">force_input</a></span></span> <span class='label'>input:</span> <span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span>
            <span class='id identifier rubyid_force_input'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_input-instance_method" title="Validator::CommandHelpers#force_input (method)">force_input</a></span></span> <span class='label'>input:</span> <span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span>
          <span class='kw'>ensure</span>
            <span class='id identifier rubyid_force_input'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_input-instance_method" title="Validator::CommandHelpers#force_input (method)">force_input</a></span></span> <span class='label'>input:</span> <span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='label'>status:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>validate:</span> <span class='kw'>false</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-70"></a>
    Traffic Light Controller IO Input is activated with M0006
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can activate input with M0006</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we activate input with M0006</p>
</li><li>
<p>Then S0003 should show the input is active</p>
</li><li>
<p>When we deactivate input with M0006</p>
</li><li>
<p>Then S0003 should show the input is inactive</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


70
71
72
73
74
75
76</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 70</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inputs</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No inputs configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_input'>input</span><span class='op'>|</span> <span class='id identifier rubyid_switch_input'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_input-instance_method" title="Validator::CommandHelpers#switch_input (method)">switch_input</a></span></span> <span class='id identifier rubyid_input'>input</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-84"></a>
    Traffic Light Controller IO Input series is activated with M0013
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can acticate/deactivate a series of inputs with M0013</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to set a serie of input</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


84
85
86
87
88
89
90</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 84</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_inputs'>inputs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>inputs</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No inputs configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_inputs'>inputs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1,3,12;5,5,10</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_set_series_of_inputs'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_series_of_inputs-instance_method" title="Validator::CommandHelpers#set_series_of_inputs (method)">set_series_of_inputs</a></span></span> <span class='id identifier rubyid_status'>status</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-98"></a>
    Traffic Light Controller IO Input sensitivity is set with M0021
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that input sensitivity can be set with M0021</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we set sensitivity with M0021</p>
</li><li>
<p>Then we receive a confirmation</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


98
99
100
101
102</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 98</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1-50</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_set_trigger_level'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_trigger_level-instance_method" title="Validator::CommandHelpers#set_trigger_level (method)">set_trigger_level</a></span></span> <span class='id identifier rubyid_status'>status</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
     &raquo; 
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-113"></a>
    Traffic Light Controller IO Output is read with S0004
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that  output status can be read with S0004</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we subscribe to S0004</p>
</li><li>
<p>We should receive a status updated</p>
</li><li>
<p>And the outputstatus attribute should be a digit string</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


113
114
115
116
117</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 113</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>output status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbrace'>{</span> <span class='label'>S0004:</span> <span class='lbracket'>[</span><span class='symbol'>:outputstatus</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-113"></a>
    Traffic Light Controller IO Output is read with S0004
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that  output status can be read with S0004</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we subscribe to S0004</p>
</li><li>
<p>We should receive a status updated</p>
</li><li>
<p>And the outputstatus attribute should be a digit string</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


113
114
115
116
117</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 113</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>output status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbrace'>{</span> <span class='label'>S0004:</span> <span class='lbracket'>[</span><span class='symbol'>:outputstatus</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-138"></a>
    Traffic Light Controller IO Output forcing is read with S0030
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that forced output status can be read with S0030</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


138
139
140
141
142</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 138</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>forced output status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbrace'>{</span> <span class='label'>S0030:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-io_spec-rb-150"></a>
    Traffic Light Controller IO Output forcing is set with M0020
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that output can be forced with M0020</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we force output with M0020</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


150
151
152
153
154
155
156
157
158
159
160</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/io_spec.rb', line 150</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
          <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
          <span class='id identifier rubyid_outputs'>outputs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>outputs</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No outputs configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='id identifier rubyid_outputs'>outputs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_output'>output</span><span class='op'>|</span>
            <span class='id identifier rubyid_force_output'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_output-instance_method" title="Validator::CommandHelpers#force_output (method)">force_output</a></span></span> <span class='label'>output:</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='label'>status:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span>
            <span class='id identifier rubyid_force_output'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_output-instance_method" title="Validator::CommandHelpers#force_output (method)">force_output</a></span></span> <span class='label'>output:</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='label'>status:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>value:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span>
          <span class='kw'>ensure</span>
            <span class='id identifier rubyid_force_output'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_output-instance_method" title="Validator::CommandHelpers#force_output (method)">force_output</a></span></span> <span class='label'>output:</span> <span class='id identifier rubyid_output'>output</span><span class='comma'>,</span> <span class='label'>status:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>validate:</span> <span class='kw'>false</span>
          <span class='kw'>end</span>
       <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-alarm_spec-rb-30"></a>
    Traffic Light Controller Alarm Alarm A0302 is raised when input is activated
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that a detector logic fault A0302 is raises and cleared.</p>

<p>The test requires that the device is programmed so that the alarm is raise when a specific input is activated, as specified in the test configuration.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we force the input to True</p>
</li><li>
<p>Then an alarm should be raised, with a timestamp close to now</p>
</li><li>
<p>When we force the input to False</p>
</li><li>
<p>Then the alarm issue should become inactive, with a timestamp close to now</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/alarm_spec.rb', line 30</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A0302</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='kw'>def</span> <span class='id identifier rubyid_verify_timestamp'>verify_timestamp</span> <span class='id identifier rubyid_alarm'>alarm</span><span class='comma'>,</span> <span class='id identifier rubyid_duration'>duration</span><span class='op'>=</span><span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_minute'>minute</span>
          <span class='id identifier rubyid_alarm_time'>alarm_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_alarm'>alarm</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>aTs</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_alarm_time'>alarm_time</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_within'>be_within</span><span class='lparen'>(</span><span class='id identifier rubyid_duration'>duration</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_of'>of</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_deactivated'>deactivated</span><span class='comma'>,</span> <span class='id identifier rubyid_component_id'>component_id</span> <span class='op'>=</span> <span class='id identifier rubyid_with_alarm_activated'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_alarm_activated-instance_method" title="Validator::CommandHelpers#with_alarm_activated (method)">with_alarm_activated</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_alarm'>alarm</span><span class='comma'>,</span><span class='id identifier rubyid_component_id'>component_id</span><span class='op'>|</span>   <span class='comment'># raise alarm, by activating input
</span>          <span class='id identifier rubyid_verify_timestamp'>verify_timestamp</span> <span class='id identifier rubyid_alarm'>alarm</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alarm </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> is now Active on component </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component_id'>component_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_verify_timestamp'>verify_timestamp</span> <span class='id identifier rubyid_deactivated'>deactivated</span>
        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alarm </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> is now Inactive on component </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component_id'>component_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-alarm_spec-rb-59"></a>
    Traffic Light Controller Alarm A0302 can be acknowledged
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that an alarm can be acknowledged.</p>

<p>The test expects that the TLC is programmed so that an detector logic fault alarm A0302 is raised and can be acknowledged when a specific input is activated. The alarm code and input nr is read from the test configuration.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we trigger an alarm</p>
</li><li>
<p>Then we should receive an unacknowledged alarm issue</p>
</li><li>
<p>When we acknowledge the alarm</p>
</li><li>
<p>Then we should receive an acknowledged alarm issue</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/alarm_spec.rb', line 59</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A0302</span><span class='tstring_end'>&#39;</span></span>   <span class='comment'># what alarm to expect
</span>        <span class='id identifier rubyid_timeout'>timeout</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>alarm</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Activating alarm </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_deactivate'>deactivate</span><span class='comma'>,</span> <span class='id identifier rubyid_component_id'>component_id</span> <span class='op'>=</span> <span class='id identifier rubyid_with_alarm_activated'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_alarm_activated-instance_method" title="Validator::CommandHelpers#with_alarm_activated (method)">with_alarm_activated</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_alarm'>alarm</span><span class='comma'>,</span> <span class='id identifier rubyid_component_id'>component_id</span><span class='op'>|</span>   <span class='comment'># raise alarm, by activating input
</span>          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alarm </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> is now active on component </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component_id'>component_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

          <span class='comment'># verify timestamp
</span>          <span class='id identifier rubyid_alarm_time'>alarm_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_alarm'>alarm</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>aTs</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_alarm_time'>alarm_time</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_within'>be_within</span><span class='lparen'>(</span><span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_minute'>minute</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_of'>of</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>

          <span class='comment'># verify that the alarm is not acknowledged when initially raised
</span>          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_alarm'>alarm</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ack</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>notAcknowledged</span><span class='regexp_end'>/i</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Alarm should not be acknowledged when raised, got: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm'>alarm</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ack</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Verified alarm </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> is correctly not acknowledged when raised</span><span class='tstring_end'>&quot;</span></span>

          <span class='comment'># test acknowledge and confirm
</span>          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Acknowledge alarm </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

          <span class='id identifier rubyid_collect_task'>collect_task</span> <span class='op'>=</span> <span class='id identifier rubyid_task'>task</span><span class='period'>.</span><span class='id identifier rubyid_async'>async</span> <span class='kw'>do</span>
            <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>AlarmCollector</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_site'>site</span><span class='comma'>,</span>
              <span class='label'>num:</span> <span class='int'>1</span><span class='comma'>,</span>
              <span class='label'>matcher:</span> <span class='lbrace'>{</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aCId</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aSp</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Acknowledge</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ack</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Acknowledged</span><span class='regexp_end'>/i</span></span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aS</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>Active</span><span class='regexp_end'>/i</span></span>
              <span class='rbrace'>}</span><span class='comma'>,</span>
              <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span>
            <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_collect!'>collect!</span>
          <span class='kw'>end</span>

          <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_send_message'>send_message</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>AlarmAcknowledge</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cId</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_component_id'>component_id</span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aTs</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_clock'>clock</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aCId</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span>
          <span class='rparen'>)</span>
          <span class='id identifier rubyid_messages'>messages</span> <span class='op'>=</span> <span class='id identifier rubyid_collect_task'>collect_task</span><span class='period'>.</span><span class='id identifier rubyid_wait'>wait</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_messages'>messages</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_an'>be_an</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a'>be_a</span><span class='lparen'>(</span><span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Alarm</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-alarm_spec-rb-114"></a>
    Traffic Light Controller Alarm A0302 can be suspended and resumed
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that alarms can be suspended. We’re using A0302 in this test.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And the alarm is resumed</p>
</li><li>
<p>When we suspend the alarm</p>
</li><li>
<p>Then we should received an alarm suspended messsage</p>
</li><li>
<p>When we resume the alarm</p>
</li><li>
<p>Then we should receive an alarm resumed message</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/alarm_spec.rb', line 114</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A0302</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_input'>input</span><span class='comma'>,</span> <span class='id identifier rubyid_component_id'>component_id</span> <span class='op'>=</span> <span class='id identifier rubyid_find_alarm_programming'><span class='object_link'><a href="../../Validator/ProgrammingHelpers.html#find_alarm_programming-instance_method" title="Validator::ProgrammingHelpers#find_alarm_programming (method)">find_alarm_programming</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='rparen'>)</span>

        <span class='comment'># first resume alarm to make sure something happens when we suspend
</span>        <span class='id identifier rubyid_resume_alarm'><span class='object_link'><a href="../../Validator/CommandHelpers.html#resume_alarm-instance_method" title="Validator::CommandHelpers#resume_alarm (method)">resume_alarm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='label'>cId:</span> <span class='id identifier rubyid_component_id'>component_id</span><span class='comma'>,</span> <span class='label'>aCId:</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='comma'>,</span> <span class='label'>collect:</span> <span class='kw'>false</span>

        <span class='kw'>begin</span>
          <span class='comment'># suspend alarm
</span>          <span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_suspend_alarm'><span class='object_link'><a href="../../Validator/CommandHelpers.html#suspend_alarm-instance_method" title="Validator::CommandHelpers#suspend_alarm (method)">suspend_alarm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='label'>cId:</span> <span class='id identifier rubyid_component_id'>component_id</span><span class='comma'>,</span> <span class='label'>aCId:</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='comma'>,</span> <span class='label'>collect:</span> <span class='kw'>true</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a'>be_a</span><span class='lparen'>(</span><span class='const'>RSMP</span><span class='op'>::</span><span class='const'>AlarmSuspended</span><span class='rparen'>)</span>

          <span class='comment'># resume alarm
</span>          <span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='id identifier rubyid_resume_alarm'><span class='object_link'><a href="../../Validator/CommandHelpers.html#resume_alarm-instance_method" title="Validator::CommandHelpers#resume_alarm (method)">resume_alarm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='label'>cId:</span> <span class='id identifier rubyid_component_id'>component_id</span><span class='comma'>,</span> <span class='label'>aCId:</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='comma'>,</span> <span class='label'>collect:</span> <span class='kw'>true</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_response'>response</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a'>be_a</span><span class='lparen'>(</span><span class='const'>RSMP</span><span class='op'>::</span><span class='const'>AlarmResumed</span><span class='rparen'>)</span>
        <span class='kw'>ensure</span>
          <span class='comment'># always end with resuming alarm
</span>          <span class='id identifier rubyid_resume_alarm'><span class='object_link'><a href="../../Validator/CommandHelpers.html#resume_alarm-instance_method" title="Validator::CommandHelpers#resume_alarm (method)">resume_alarm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='label'>cId:</span> <span class='id identifier rubyid_component_id'>component_id</span><span class='comma'>,</span> <span class='label'>aCId:</span> <span class='id identifier rubyid_alarm_code_id'>alarm_code_id</span><span class='comma'>,</span> <span class='label'>collect:</span> <span class='kw'>false</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-22"></a>
    Traffic Light Controller Clock can be read with S0096
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status 0096 current date and time</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


22
23
24
25
26
27
28
29
30
31
32</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 22</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>current date and time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0096:</span> <span class='lbracket'>[</span>
            <span class='symbol'>:year</span><span class='comma'>,</span>
            <span class='symbol'>:month</span><span class='comma'>,</span>
            <span class='symbol'>:day</span><span class='comma'>,</span>
            <span class='symbol'>:hour</span><span class='comma'>,</span>
            <span class='symbol'>:minute</span><span class='comma'>,</span>
            <span class='symbol'>:second</span><span class='comma'>,</span>
          <span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-41"></a>
    Traffic Light Controller Clock can be set with M0104
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that the controller responds to M0104</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send command</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


41
42
43
44</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 41</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_clock'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_clock-instance_method" title="Validator::CommandHelpers#set_clock (method)">set_clock</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span><span class='rparen'>)</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-55"></a>
    Traffic Light Controller Clock is used for S0096 status response
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0096 clock after changing clock</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to set_clock</p>
</li><li>
<p>Request status S0096</p>
</li><li>
<p>Compare set_clock and status timestamp</p>
</li><li>
<p>Expect the difference to be within max_diff</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 55</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>
            <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0096:</span> <span class='lbracket'>[</span>
              <span class='symbol'>:year</span><span class='comma'>,</span>
              <span class='symbol'>:month</span><span class='comma'>,</span>
              <span class='symbol'>:day</span><span class='comma'>,</span>
              <span class='symbol'>:hour</span><span class='comma'>,</span>
              <span class='symbol'>:minute</span><span class='comma'>,</span>
              <span class='symbol'>:second</span><span class='comma'>,</span>
            <span class='rbracket'>]</span> <span class='rbrace'>}</span>
            <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_request_status'>request_status</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_convert_status_list'><span class='object_link'><a href="../../Validator/StatusHelpers.html#convert_status_list-instance_method" title="Validator::StatusHelpers#convert_status_list (method)">convert_status_list</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_status_list'>status_list</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>collect!:</span> <span class='lbrace'>{</span>
              <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='rbrace'>}</span>
            <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='id identifier rubyid_status_list'>status_list</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>

            <span class='id identifier rubyid_received'>received</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
              <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_matcher_result'>matcher_result</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>year</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_matcher_result'>matcher_result</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>month</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_matcher_result'>matcher_result</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>day</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_matcher_result'>matcher_result</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hour</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_matcher_result'>matcher_result</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>minute</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_matcher_result'>matcher_result</span><span class='lparen'>(</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>n</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>second</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span> <span class='rparen'>)</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UTC</span><span class='tstring_end'>&#39;</span></span>
            <span class='rparen'>)</span>

            <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span>
              <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span>
              <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_received'>received</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
            <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Clock reported by S0096 is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-104"></a>
    Traffic Light Controller Clock is used for S0096 response timestamp
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status response timestamp after changing clock</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to set_clock</p>
</li><li>
<p>Request status S0096</p>
</li><li>
<p>Compare set_clock and response timestamp</p>
</li><li>
<p>Expect the difference to be within max_diff</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 104</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>
            <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0096:</span> <span class='lbracket'>[</span>
              <span class='symbol'>:year</span><span class='comma'>,</span>
              <span class='symbol'>:month</span><span class='comma'>,</span>
              <span class='symbol'>:day</span><span class='comma'>,</span>
              <span class='symbol'>:hour</span><span class='comma'>,</span>
              <span class='symbol'>:minute</span><span class='comma'>,</span>
              <span class='symbol'>:second</span><span class='comma'>,</span>
            <span class='rbracket'>]</span> <span class='rbrace'>}</span>

            <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_request_status'>request_status</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
              <span class='id identifier rubyid_convert_status_list'><span class='object_link'><a href="../../Validator/StatusHelpers.html#convert_status_list-instance_method" title="Validator::StatusHelpers#convert_status_list (method)">convert_status_list</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_status_list'>status_list</span><span class='rparen'>)</span><span class='comma'>,</span>
              <span class='label'>collect!:</span> <span class='lbrace'>{</span>
                <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
              <span class='rbrace'>}</span>
            <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span>

            <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sTs</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
            <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timestamp of S0096 is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-143"></a>
    Traffic Light Controller Clock is used for aggregated status timestamp
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify aggregated status response timestamp after changing clock</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to set clock</p>
</li><li>
<p>Wait for status = true</p>
</li><li>
<p>Request aggregated status</p>
</li><li>
<p>Compare set_clock and response timestamp</p>
</li><li>
<p>Expect the difference to be within max_diff</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 143</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>
            <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_request_aggregated_status'>request_aggregated_status</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='label'>collect!:</span> <span class='lbrace'>{</span>
              <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='rbrace'>}</span>
            <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>aSTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
            <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timestamp of aggregated status is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-169"></a>
    Traffic Light Controller Clock is used for M0001 response timestamp
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify command response timestamp after changing clock</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to set clock</p>
</li><li>
<p>Send command to set functional position</p>
</li><li>
<p>Compare set_clock and response timestamp</p>
</li><li>
<p>Expect the difference to be within max_diff</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


169
170
171
172
173
174
175
176
177
178
179
180
181
182</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 169</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>
            <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_set_functional_position'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_functional_position-instance_method" title="Validator::CommandHelpers#set_functional_position (method)">set_functional_position</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NormalControl</span><span class='tstring_end'>&#39;</span></span>
            <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>*</span> <span class='int'>2</span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
            <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timestamp of command response is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-193"></a>
    Traffic Light Controller Clock is used for M0104 response timestamp
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify command response timestamp after changing clock</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to set clock</p>
</li><li>
<p>Send command to set functional position</p>
</li><li>
<p>Compare set_clock and response timestamp</p>
</li><li>
<p>Expect the difference to be within max_diff</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 193</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>
            <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_set_functional_position'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_functional_position-instance_method" title="Validator::CommandHelpers#set_functional_position (method)">set_functional_position</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NormalControl</span><span class='tstring_end'>&#39;</span></span>
            <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cTS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
            <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timestamp of command response is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-221"></a>
    Traffic Light Controller Clock is used for alarm timestamp
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify timestamp of alarm after changing clock The test requires the device to be programmed so that a A0302 alarm can be raise by activating a specific input, as configuted in the test config.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send a command to change the clock</p>
</li><li>
<p>And we raise an alarm, by acticate an input</p>
</li><li>
<p>Then we should receive an alarm</p>
</li><li>
<p>And the alarm timestamp should be close to the time set the clock to</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


221
222
223
224
225
226
227
228
229
230
231
232
233
234</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 221</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>                           <span class='comment'># set clock
</span>            <span class='id identifier rubyid_with_alarm_activated'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_alarm_activated-instance_method" title="Validator::CommandHelpers#with_alarm_activated (method)">with_alarm_activated</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A0302</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_alarm'>alarm</span><span class='op'>|</span>   <span class='comment'># raise alarm, by activating input
</span>              <span class='id identifier rubyid_alarm_time'>alarm_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span> <span class='id identifier rubyid_alarm'>alarm</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>aTs</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>
              <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
              <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_alarm_time'>alarm_time</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
              <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timestamp of alarm is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-clock_spec-rb-245"></a>
    Traffic Light Controller Clock is used for watchdog timestamp
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify timestamp of watchdog after changing clock</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send control command to setset_clock</p>
</li><li>
<p>Wait for Watchdog</p>
</li><li>
<p>Compare set_clock and alarm response timestamp</p>
</li><li>
<p>Expect the difference to be within max_diff</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


245
246
247
248
249
250
251
252
253
254
255
256
257
258
259</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/clock_spec.rb', line 245</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_with_watchdog_disabled'>with_watchdog_disabled</span> <span class='kw'>do</span>  <span class='comment'># avoid time synchronization by disabling watchdogs
</span>          <span class='id identifier rubyid_with_clock_set'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_clock_set-instance_method" title="Validator::CommandHelpers#with_clock_set (method)">with_clock_set</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span> <span class='kw'>do</span>
            <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Checking watchdog timestamp</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_collector'>collector</span> <span class='op'>=</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Collector</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='label'>task:</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Watchdog</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='label'>num:</span> <span class='int'>1</span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>watchdog</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_collect!'>collect!</span>
            <span class='id identifier rubyid_max_diff'>max_diff</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>command_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_response</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_collector'>collector</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>wTs</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>-</span> <span class='const'><span class='object_link'><a href="../../top-level-namespace.html#CLOCK-constant" title="CLOCK (constant)">CLOCK</a></span></span>
            <span class='id identifier rubyid_diff'>diff</span> <span class='op'>=</span> <span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span>
            <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_diff'>diff</span><span class='period'>.</span><span class='id identifier rubyid_abs'>abs</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be'>be</span> <span class='op'>&lt;=</span> <span class='id identifier rubyid_max_diff'>max_diff</span><span class='comma'>,</span>
              <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Timestamp of watchdog is off by </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_diff'>diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s, should be within </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_max_diff'>max_diff</span><span class='embexpr_end'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-11"></a>
    Traffic Light Controller Operational control mode is read with S0020
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0020 control mode</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>control mode</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0020:</span> <span class='lbracket'>[</span><span class='symbol'>:controlmode</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-23"></a>
    Traffic Light Controller Operational startup status is read with S0005
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0005 traffic controller starting by intersection statusByIntersection requires core &gt;= 3.2, since it uses the array data type.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


23
24
25
26</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 23</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic controller starting (true/false)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0005:</span> <span class='lbracket'>[</span><span class='symbol'>:statusByIntersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-23"></a>
    Traffic Light Controller Operational startup status is read with S0005
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0005 traffic controller starting by intersection statusByIntersection requires core &gt;= 3.2, since it uses the array data type.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


23
24
25
26</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 23</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic controller starting (true/false)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0005:</span> <span class='lbracket'>[</span><span class='symbol'>:statusByIntersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-48"></a>
    Traffic Light Controller Operational switched on is read with S0007
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0007 controller switched on, source attribute</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


48
49
50
51</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 48</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0007:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>controller switch on (dark mode=off)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-48"></a>
    Traffic Light Controller Operational switched on is read with S0007
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0007 controller switched on, source attribute</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


48
49
50
51</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 48</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0007:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>controller switch on (dark mode=off)</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-72"></a>
    Traffic Light Controller Operational manual control is read with S0008
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0008 manual control</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


72
73
74
75
76
77
78
79</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 72</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0008:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0008:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>manual control status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-88"></a>
    Traffic Light Controller Operational fixed time control is read with S0009
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0009 fixed time control</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


88
89
90
91
92
93
94
95</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 88</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0009:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0009:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>fixed time control status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-106"></a>
    Traffic Light Controller Operational fixed time control can be activated with M0007
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify command M0007 fixed time control</p>
<ol><li>
<p>Verify connection</p>
</li><li>
<p>Send command to switch to fixed time = true</p>
</li><li>
<p>Wait for status = true</p>
</li><li>
<p>Send command to switch to fixed time = false</p>
</li><li>
<p>Wait for status = false</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


106
107
108
109
110</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 106</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_switch_fixed_time'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_fixed_time-instance_method" title="Validator::CommandHelpers#switch_fixed_time (method)">switch_fixed_time</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span>
        <span class='id identifier rubyid_switch_fixed_time'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_fixed_time-instance_method" title="Validator::CommandHelpers#switch_fixed_time (method)">switch_fixed_time</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-119"></a>
    Traffic Light Controller Operational isolated control is read with S0010
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0010 isolated control</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


119
120
121
122
123
124
125
126</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 119</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0010:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0010:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>isolated control status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-135"></a>
    Traffic Light Controller Operational coordinated control is read with S0032
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0032 coordinated control</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


135
136
137
138</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 135</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0032:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>coordinated control status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-147"></a>
    Traffic Light Controller Operational yellow flash can be read with S0011
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0011 yellow flash</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


147
148
149
150
151
152
153
154</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 147</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0011:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0011:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>yellow flash status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-165"></a>
    Traffic Light Controller Operational yellow flash can be activated with M0001
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can activate yellow flash</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send the control command to switch to Yellow flash</p>
</li><li>
<p>Wait for status Yellow flash</p>
</li><li>
<p>Send command to switch to normal control</p>
</li><li>
<p>Wait for status “Yellow flash” = false, “Controller starting”= false, “Controller on”= true“</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


165
166
167
168
169</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 165</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_switch_yellow_flash'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_yellow_flash-instance_method" title="Validator::CommandHelpers#switch_yellow_flash (method)">switch_yellow_flash</a></span></span>
        <span class='id identifier rubyid_switch_normal_control'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_normal_control-instance_method" title="Validator::CommandHelpers#switch_normal_control (method)">switch_normal_control</a></span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-180"></a>
    Traffic Light Controller Operational yellow flash affects all signal groups
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can yellow flash causes all groups to go to state ‘c’</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send the control command to switch to Yellow flash</p>
</li><li>
<p>Wait for all groups to go to group ‘c’</p>
</li><li>
<p>Send command to switch to normal control</p>
</li><li>
<p>Wait for all groups to switch do something else that ‘c’</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


180
181
182
183
184
185
186
187
188
189</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 180</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span>  <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>yellow_flash</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

        <span class='id identifier rubyid_switch_yellow_flash'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_yellow_flash-instance_method" title="Validator::CommandHelpers#switch_yellow_flash (method)">switch_yellow_flash</a></span></span>
        <span class='id identifier rubyid_wait_for_groups'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_groups-instance_method" title="Validator::StatusHelpers#wait_for_groups (method)">wait_for_groups</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>c</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span>      <span class='comment'># c mean s yellow flash
</span>
        <span class='id identifier rubyid_switch_normal_control'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_normal_control-instance_method" title="Validator::CommandHelpers#switch_normal_control (method)">switch_normal_control</a></span></span>
        <span class='id identifier rubyid_wait_for_groups'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_groups-instance_method" title="Validator::StatusHelpers#wait_for_groups (method)">wait_for_groups</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>[^c]</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span>   <span class='comment'># not c, ie. not yellow flash
</span>      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-198"></a>
    Traffic Light Controller Operational all red can be read with S0012
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0012 all red</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


198
199
200
201
202
203
204
205</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 198</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0012:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0012:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:intersection</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all-red status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-214"></a>
    Traffic Light Controller Operational police key can be read with S0013
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0013 police key</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


214
215
216
217</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 214</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>police key</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0013:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-228"></a>
    Traffic Light Controller Operational dark mode can be activated with M0001
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can activate dark mode</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send the control command to switch todarkmode</p>
</li><li>
<p>Wait for status“Controller on” = false</p>
</li><li>
<p>Send command to switch to normal control</p>
</li><li>
<p>Wait for status “Yellow flash” = false, “Controller starting”= false, “Controller on”= true“</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


228
229
230
231
232</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 228</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_switch_dark_mode'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_dark_mode-instance_method" title="Validator::CommandHelpers#switch_dark_mode (method)">switch_dark_mode</a></span></span>
        <span class='id identifier rubyid_switch_normal_control'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_normal_control-instance_method" title="Validator::CommandHelpers#switch_normal_control (method)">switch_normal_control</a></span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-modes_spec-rb-243"></a>
    Traffic Light Controller Operational yellow flash be used with a timeout of one minute
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can activate yellow flash and after 1 minute goes back to NormalControl</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Send the control command to switch to Normal Control, and wait for this</p>
</li><li>
<p>Send the control command to switch to Yellow flash</p>
</li><li>
<p>Wait for status Yellow flash</p>
</li><li>
<p>Wait for automatic revert to Normal Control</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


243
244
245
246
247
248
249</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/modes_spec.rb', line 243</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_switch_normal_control'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_normal_control-instance_method" title="Validator::CommandHelpers#switch_normal_control (method)">switch_normal_control</a></span></span>
        <span class='id identifier rubyid_minutes'>minutes</span> <span class='op'>=</span> <span class='int'>1</span>
        <span class='id identifier rubyid_switch_yellow_flash'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_yellow_flash-instance_method" title="Validator::CommandHelpers#switch_yellow_flash (method)">switch_yellow_flash</a></span></span> <span class='label'>timeout_minutes:</span> <span class='id identifier rubyid_minutes'>minutes</span>
        <span class='id identifier rubyid_wait_normal_control'><span class='object_link'><a href="../../Validator/CommandHelpers.html#wait_normal_control-instance_method" title="Validator::CommandHelpers#wait_normal_control (method)">wait_normal_control</a></span></span> <span class='label'>timeout:</span> <span class='id identifier rubyid_minutes'>minutes</span><span class='op'>*</span><span class='int'>60</span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>functional_position</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-system_spec-rb-11"></a>
    Traffic Light Controller System operator logged in/out of OP-panel is read with S0091
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0091 operator logged in/out OP-panel</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14
15
16
17
18</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/system_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0091:</span> <span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0091:</span> <span class='lbracket'>[</span><span class='symbol'>:user</span><span class='comma'>,</span> <span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>operator logged in/out OP-panel</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-system_spec-rb-27"></a>
    Traffic Light Controller System operator logged in/out of web-interface is read with S0092
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0092 operator logged in/out web-interface</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


27
28
29
30
31
32
33
34</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/system_spec.rb', line 27</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0092:</span> <span class='lbracket'>[</span><span class='symbol'>:user</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0092:</span> <span class='lbracket'>[</span><span class='symbol'>:user</span><span class='comma'>,</span> <span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>operator logged in/out web-interface</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-system_spec-rb-43"></a>
    Traffic Light Controller System version is read with S0095 
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0095 version of traffic controller</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


43
44
45
46</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/system_spec.rb', line 43</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version of traffic controller</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
        <span class='lbrace'>{</span> <span class='label'>S0095:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-system_spec-rb-55"></a>
    Traffic Light Controller System security code is set with M0103
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      <ol><li>
<p>Verify connection</p>
</li><li>
<p>Send control command to set securitycode_level</p>
</li><li>
<p>Wait for status = true</p>
</li><li>
<p>Send control command to setsecuritycode_level</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


55
56
57
58
59</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/system_spec.rb', line 55</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_security_code'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_security_code-instance_method" title="Validator::CommandHelpers#set_security_code (method)">set_security_code</a></span></span> <span class='int'>1</span>
        <span class='id identifier rubyid_set_security_code'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_security_code-instance_method" title="Validator::CommandHelpers#set_security_code (method)">set_security_code</a></span></span> <span class='int'>2</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-system_spec-rb-69"></a>
    Traffic Light Controller System security code is rejected when incorrect
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that the site responds with NotAck if we send incorrect security cdoes. RThis hehaviour is defined in SXL &gt;= 1.1. For earlier versions, The behaviour is undefined.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send a M0008 command with incorrect security codes</p>
</li><li>
<p>Then we should received a NotAck</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


69
70
71
72</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/system_spec.rb', line 69</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_expect'>expect</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_wrong_security_code'><span class='object_link'><a href="../../Validator/CommandHelpers.html#wrong_security_code-instance_method" title="Validator::CommandHelpers#wrong_security_code (method)">wrong_security_code</a></span></span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_raise_error'>raise_error</span><span class='lparen'>(</span><span class='const'>RSMP</span><span class='op'>::</span><span class='const'>MessageRejected</span><span class='rparen'>)</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-subscribe_spec-rb-15"></a>
    Traffic Light Controller Subscription can be turned on and off for S0001
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Check that we can <strong>subscribe</strong> to status messages. The test subscribes to S0001 (signal group status), because it will usually change once per second, but otherwise the choice is arbitrary as we simply want to check that the subscription mechanism works.</p>
<ol><li>
<p>subscribe</p>
</li><li>
<p>check that we receive a status update with a predefined time</p>
</li><li>
<p>unsubscribe</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/subscribe_spec.rb', line 15</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subscribe to status and wait for update</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_component'>component</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

        <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0001</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>signalgroupstatus</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uRt</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_status_list'>status_list</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sOc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_use_sOc?'><span class='object_link'><a href="../../Validator/StatusHelpers.html#use_sOc%3F-instance_method" title="Validator::StatusHelpers#use_sOc? (method)">use_sOc?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_site'>site</span><span class='rparen'>)</span>

         <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_subscribe_to_status'>subscribe_to_status</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span><span class='comma'>,</span> <span class='label'>collect!:</span> <span class='lbrace'>{</span>
          <span class='label'>timeout:</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status_update</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='rbrace'>}</span>
      <span class='kw'>ensure</span>
        <span class='id identifier rubyid_unsubscribe_list'>unsubscribe_list</span> <span class='op'>=</span> <span class='id identifier rubyid_status_list'>status_list</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_slice'>slice</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_unsubscribe_to_status'>unsubscribe_to_status</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_unsubscribe_list'>unsubscribe_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-subscribe_spec-rb-41"></a>
    Traffic Light Controller Subscription can change interval during active subscription
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Check that we can change the update rate interval while status subscription is active. The test subscribes to S0001 ‘cyclecounter’ attribute with an initial update rate of 60s, then changes the update rate to 1s and verifies the new rate is in effect.</p>
<ol><li>
<p>Subscribe to S0001 ‘cyclecounter’ with update rate 60s</p>
</li><li>
<p>Verify that subscription succeeds</p>
</li><li>
<p>Send the same subscription again with update rate 1s</p>
</li><li>
<p>Verify that the new update rate is in effect by checking next update is received within 2s</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/subscribe_spec.rb', line 41</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_component'>component</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        
        <span class='comment'># Step 1: Subscribe with 60s update rate (no need to wait for updates with long interval)
</span>        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subscribe to S0001 cyclecounter with 60s update rate</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_initial_status_list'>initial_status_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0001</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cyclecounter</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uRt</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>60</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_initial_status_list'>initial_status_list</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sOc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_use_sOc?'><span class='object_link'><a href="../../Validator/StatusHelpers.html#use_sOc%3F-instance_method" title="Validator::StatusHelpers#use_sOc? (method)">use_sOc?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_site'>site</span><span class='rparen'>)</span>

        <span class='comment'># Subscribe but don&#39;t wait for updates (since 60s is too long)
</span>        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_subscribe_to_status'>subscribe_to_status</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_initial_status_list'>initial_status_list</span>
        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Initial subscription with 60s update rate successful</span><span class='tstring_end'>&quot;</span></span>

        <span class='comment'># Step 3: Change update rate to 1s by re-subscribing and verify we get update within 2s
</span>        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Change update rate to 1s by re-subscribing and verify update within 2s</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_updated_status_list'>updated_status_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0001</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cyclecounter</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uRt</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_updated_status_list'>updated_status_list</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sOc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_use_sOc?'><span class='object_link'><a href="../../Validator/StatusHelpers.html#use_sOc%3F-instance_method" title="Validator::StatusHelpers#use_sOc? (method)">use_sOc?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_site'>site</span><span class='rparen'>)</span>

        <span class='comment'># This should collect at least one status update within 2s if the 1s rate is working
</span>        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_subscribe_to_status'>subscribe_to_status</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_updated_status_list'>updated_status_list</span><span class='comma'>,</span> <span class='label'>collect!:</span> <span class='lbrace'>{</span>
          <span class='label'>timeout:</span> <span class='int'>2</span>
        <span class='rbrace'>}</span>
        
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_not'>to_not</span> <span class='id identifier rubyid_be_nil'>be_nil</span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_not'>to_not</span> <span class='id identifier rubyid_be_empty'>be_empty</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Expected to receive status update within 2s with new 1s update rate</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully received status update within 2s, confirming 1s update rate is active</span><span class='tstring_end'>&quot;</span></span>

      <span class='kw'>ensure</span>
        <span class='comment'># Clean up subscription
</span>        <span class='id identifier rubyid_unsubscribe_list'>unsubscribe_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0001</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>cyclecounter</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_unsubscribe_to_status'>unsubscribe_to_status</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_unsubscribe_list'>unsubscribe_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-11"></a>
    Traffic Light Controller Signal Plan currently active is read with S0014
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0014 current time plan</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14
15
16
17
18</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0014:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0014:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>current time plan</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-29"></a>
    Traffic Light Controller Signal Plan currently active is set with M0002
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we change time plan (signal program) We try switching all programs configured</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And there is a Validator.get_config(‘validator’) with a time plan</p>
</li><li>
<p>When we send the command</p>
</li><li>
<p>We should receive a confirmative command response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


29
30
31
32
33
34</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 29</span>

<span class='id identifier rubyid_plans'>plans</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plans</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No time plans configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_plans'>plans</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_plans'>plans</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_plans'>plans</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_plan'>plan</span><span class='op'>|</span> <span class='id identifier rubyid_switch_plan'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_plan-instance_method" title="Validator::CommandHelpers#switch_plan (method)">switch_plan</a></span></span> <span class='id identifier rubyid_plan'>plan</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-44"></a>
    Traffic Light Controller Signal Plan list size is read with S0018
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0018 number of time plans Deprecated from 1.2, use S0022 instead.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


44
45
46
47</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 44</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>number of time plans</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0018:</span> <span class='lbracket'>[</span><span class='symbol'>:number</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-56"></a>
    Traffic Light Controller Signal Plan list is read with S0022
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0022 list of time plans</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


56
57
58
59</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 56</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>list of time plans</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0022:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-68"></a>
    Traffic Light Controller Signal Plan week table is read with S0026
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0026 week time table</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


68
69
70
71</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 68</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>week time table</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0026:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-80"></a>
    Traffic Light Controller Signal Plan week table is set with M0016
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can set week table with M0016</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send the command</p>
</li><li>
<p>We should receive a confirmative command response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


80
81
82
83
84</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 80</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>0-1,6-2</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_week_table'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_week_table-instance_method" title="Validator::CommandHelpers#set_week_table (method)">set_week_table</a></span></span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-93"></a>
    Traffic Light Controller Signal Plan day table is read with S0027
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0027 time tables</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


93
94
95
96</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 93</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>command table</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0027:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-105"></a>
    Traffic Light Controller Signal Plan day table is set with M0017
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can set day table with M0017</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send the command</p>
</li><li>
<p>We should receive a confirmative command response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


105
106
107
108
109</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 105</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>12-1-12-59,1-0-23-12</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_day_table'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_day_table-instance_method" title="Validator::CommandHelpers#set_day_table (method)">set_day_table</a></span></span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-118"></a>
    Traffic Light Controller Signal Plan version is read with S0097
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0097 version of traffic program</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


118
119
120
121</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 118</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>version of traffic program</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0097:</span> <span class='lbracket'>[</span><span class='symbol'>:timestamp</span><span class='comma'>,</span><span class='symbol'>:checksum</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-130"></a>
    Traffic Light Controller Signal Plan config is read with S0098
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0098 configuration of traffic parameters</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


130
131
132
133
134
135
136
137
138
139
140
141
142</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 130</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>config of traffic parameters</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0098:</span> <span class='lbracket'>[</span><span class='symbol'>:timestamp</span><span class='comma'>,</span><span class='symbol'>:config</span><span class='comma'>,</span><span class='symbol'>:version</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>

        <span class='comment'># the site  should have stored the received status
</span>        <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_messages'>messages</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_message'>message</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_an'>be_an</span><span class='lparen'>(</span><span class='const'>RSMP</span><span class='op'>::</span><span class='const'>StatusResponse</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_values'>values</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sS</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span>

        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timestamp</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_not_to'>not_to</span> <span class='id identifier rubyid_be_empty'>be_empty</span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>config</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_not_to'>not_to</span> <span class='id identifier rubyid_be_empty'>be_empty</span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timestamp</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_not_to'>not_to</span> <span class='id identifier rubyid_be_empty'>be_empty</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-151"></a>
    Traffic Light Controller Signal Plan dynamic bands are read with S0023
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0023 command table</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


151
152
153
154</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 151</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>command table</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0023:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-163"></a>
    Traffic Light Controller Signal Plan dynamic bands are set with M0014
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that dynamic bands can the set with M0014</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send the command</p>
</li><li>
<p>We should receive a confirmative command response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


163
164
165
166
167
168</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 163</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_plan'>plan</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plans</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1-12</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_dynamic_bands-instance_method" title="Validator::CommandHelpers#set_dynamic_bands (method)">set_dynamic_bands</a></span></span> <span class='id identifier rubyid_plan'>plan</span><span class='comma'>,</span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-181"></a>
    Traffic Light Controller Signal Plan dynamic bands values can be changed and read back
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that dynamic bands can be read and changed</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And we read dynamic band</p>
</li><li>
<p>When we set dynamic band to 2x previous value</p>
</li><li>
<p>Then reading dynamic bands should confirm the change</p>
</li><li>
<p>Finally when we revert dynamic band to previous value</p>
</li><li>
<p>Then reading dynamic bands should confirm the reversion</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 181</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_plan'>plan</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plans</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_band'>band</span> <span class='op'>=</span> <span class='int'>3</span>

        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_get_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#get_dynamic_bands-instance_method" title="Validator::CommandHelpers#get_dynamic_bands (method)">get_dynamic_bands</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_plan'>plan</span><span class='comma'>,</span> <span class='id identifier rubyid_band'>band</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='int'>0</span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a'>be_a</span><span class='lparen'>(</span><span class='const'>Integer</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_new_value'>new_value</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>+</span> <span class='int'>1</span>
        
        <span class='id identifier rubyid_set_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_dynamic_bands-instance_method" title="Validator::CommandHelpers#set_dynamic_bands (method)">set_dynamic_bands</a></span></span> <span class='id identifier rubyid_plan'>plan</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_band'>band</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_new_value'>new_value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span> <span class='id identifier rubyid_get_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#get_dynamic_bands-instance_method" title="Validator::CommandHelpers#get_dynamic_bands (method)">get_dynamic_bands</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_plan'>plan</span><span class='comma'>,</span> <span class='id identifier rubyid_band'>band</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_new_value'>new_value</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_set_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_dynamic_bands-instance_method" title="Validator::CommandHelpers#set_dynamic_bands (method)">set_dynamic_bands</a></span></span> <span class='id identifier rubyid_plan'>plan</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_band'>band</span><span class='embexpr_end'>}</span><span class='tstring_content'>-</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_value'>value</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span> <span class='id identifier rubyid_get_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#get_dynamic_bands-instance_method" title="Validator::CommandHelpers#get_dynamic_bands (method)">get_dynamic_bands</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_plan'>plan</span><span class='comma'>,</span> <span class='id identifier rubyid_band'>band</span><span class='rparen'>)</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_eq'>eq</span><span class='lparen'>(</span><span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-207"></a>
    Traffic Light Controller Signal Plan timeout for dynamic bands is set with M0023
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify command M0023 timeout of dynamic bands</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send command to set timeout</p>
</li><li>
<p>Then we should get a confirmation</p>
</li><li>
<p>When we send command to disable timeout</p>
</li><li>
<p>Then we should get a confirmation</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


207
208
209
210
211
212
213</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 207</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>10</span>
        <span class='id identifier rubyid_set_timeout_for_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_timeout_for_dynamic_bands-instance_method" title="Validator::CommandHelpers#set_timeout_for_dynamic_bands (method)">set_timeout_for_dynamic_bands</a></span></span> <span class='id identifier rubyid_status'>status</span>
        <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>0</span>
        <span class='id identifier rubyid_set_timeout_for_dynamic_bands'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_timeout_for_dynamic_bands-instance_method" title="Validator::CommandHelpers#set_timeout_for_dynamic_bands (method)">set_timeout_for_dynamic_bands</a></span></span> <span class='id identifier rubyid_status'>status</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-222"></a>
    Traffic Light Controller Signal Plan offset is read with S0024
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0024 offset time</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


222
223
224
225</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 222</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>offset time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0024:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-232"></a>
    Traffic Light Controller Signal Plan offset is set with M0015
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      <ol><li>
<p>Verify connection</p>
</li><li>
<p>Send control command to set dynamic_bands</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


232
233
234
235
236
237</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 232</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_plan'>plan</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plans</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>99</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_offset'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_offset-instance_method" title="Validator::CommandHelpers#set_offset (method)">set_offset</a></span></span> <span class='id identifier rubyid_status'>status</span><span class='comma'>,</span> <span class='id identifier rubyid_plan'>plan</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-246"></a>
    Traffic Light Controller Signal Plan cycle time is read with S0028
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0028 cycle time</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request the status</p>
</li><li>
<p>We should receive a status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


246
247
248
249</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 246</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cycle time</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0028:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_plans_spec-rb-261"></a>
    Traffic Light Controller Signal Plan cycle time is set with M0018
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that cycle time can be changed with M0018</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And we read cycle times</p>
</li><li>
<p>When we extend cycle time of curent plan with 5s</p>
</li><li>
<p>Then reading the cycle time should confirm the change</p>
</li><li>
<p>Finally when we revert cycle time to previous value</p>
</li><li>
<p>Then reading cycle time should confirm the reversion</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


261
262
263
264
265</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_plans_spec.rb', line 261</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_with_cycle_time_extended'><span class='object_link'><a href="../../Validator/CommandHelpers.html#with_cycle_time_extended-instance_method" title="Validator::CommandHelpers#with_cycle_time_extended (method)">with_cycle_time_extended</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_site'>site</span><span class='rparen'>)</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cycle time extension confirmed</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-11"></a>
    Traffic Light Controller Traffic Data number of vehicles for a single detector is read with S0201
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0201 traffic counting: number of vehicles</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14
15</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: number of vehicles</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0201:</span> <span class='lbracket'>[</span><span class='symbol'>:starttime</span><span class='comma'>,</span><span class='symbol'>:vehicles</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detector_logic</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-24"></a>
    Traffic Light Controller Traffic Data number of vehicles for all detectors is read with S0205
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0205 traffic counting: number of vehicles</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


24
25
26
27</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 24</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: number of vehicles</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0205:</span> <span class='lbracket'>[</span><span class='symbol'>:start</span><span class='comma'>,</span><span class='symbol'>:vehicles</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-36"></a>
    Traffic Light Controller Traffic Data vehicle speed for a single detector is read with S0202
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0202 traffic counting: vehicle speed</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


36
37
38
39
40</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 36</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: vehicle speed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0202:</span> <span class='lbracket'>[</span><span class='symbol'>:starttime</span><span class='comma'>,</span><span class='symbol'>:speed</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detector_logic</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-49"></a>
    Traffic Light Controller Traffic Data vehicle speed for all detectors is read with S0206
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0206 traffic counting: vehicle speed</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


49
50
51
52</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 49</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: vehicle speed</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0206:</span> <span class='lbracket'>[</span><span class='symbol'>:start</span><span class='comma'>,</span><span class='symbol'>:speed</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-61"></a>
    Traffic Light Controller Traffic Data occupancy for a single detector is read with S0203
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0203 traffic counting: occupancy</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


61
62
63
64
65</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 61</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: occupancy</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0203:</span> <span class='lbracket'>[</span><span class='symbol'>:starttime</span><span class='comma'>,</span><span class='symbol'>:occupancy</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detector_logic</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-74"></a>
    Traffic Light Controller Traffic Data occupancy for all detectors is read with S0207
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0207 traffic counting: occupancy</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 74</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_result'>result</span> <span class='op'>=</span> <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: occupancy</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0207:</span> <span class='lbracket'>[</span><span class='symbol'>:start</span><span class='comma'>,</span><span class='symbol'>:occupancy</span><span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='label'>update_rate:</span> <span class='int'>60</span>
        
        <span class='id identifier rubyid_occupancies'>occupancies</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_matcher_got_hash'>matcher_got_hash</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S0207</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>occupancy</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_start'>start</span> <span class='op'>=</span> <span class='id identifier rubyid_result'>result</span><span class='lbracket'>[</span><span class='symbol'>:collector</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_matcher_got_hash'>matcher_got_hash</span><span class='period'>.</span><span class='id identifier rubyid_dig'>dig</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>S0207</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>start</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_occupancies'>occupancies</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a'>be_a</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Occupancies must be a string, but got nil</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='id identifier rubyid_start'>start</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_a'>be_a</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Start must be a string, but got nil</span><span class='tstring_end'>&quot;</span></span>
        
        <span class='id identifier rubyid_occupancies'>occupancies</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>,</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_occupancy'>occupancy</span><span class='op'>|</span>
          <span class='id identifier rubyid_num'>num</span> <span class='op'>=</span> <span class='id identifier rubyid_occupancy'>occupancy</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
          <span class='id identifier rubyid_expect'>expect</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='op'>-</span><span class='int'>1</span><span class='op'>..</span><span class='int'>100</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_cover?'>cover?</span><span class='lparen'>(</span><span class='id identifier rubyid_num'>num</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to'>to</span> <span class='id identifier rubyid_be_truthy'>be_truthy</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Occupancy must be in the range -1..100, got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_num'>num</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-99"></a>
    Traffic Light Controller Traffic Data classification for a single detector is read with S0204
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0204 traffic counting: classification</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 99</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: classification</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0204:</span> <span class='lbracket'>[</span>
              <span class='symbol'>:starttime</span><span class='comma'>,</span>
              <span class='symbol'>:P</span><span class='comma'>,</span>
              <span class='symbol'>:PS</span><span class='comma'>,</span>
              <span class='symbol'>:L</span><span class='comma'>,</span>
              <span class='symbol'>:LS</span><span class='comma'>,</span>
              <span class='symbol'>:B</span><span class='comma'>,</span>
              <span class='symbol'>:SP</span><span class='comma'>,</span>
              <span class='symbol'>:MC</span><span class='comma'>,</span>
              <span class='symbol'>:C</span><span class='comma'>,</span>
              <span class='symbol'>:F</span>
          <span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detector_logic</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_data_spec-rb-123"></a>
    Traffic Light Controller Traffic Data classification for all detectors is read with S0208
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0208 traffic counting: classification</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


123
124
125
126
127
128
129
130
131
132
133
134
135
136
137</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_data_spec.rb', line 123</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>traffic counting: classification</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0208:</span> <span class='lbracket'>[</span>
              <span class='symbol'>:start</span><span class='comma'>,</span>
              <span class='symbol'>:P</span><span class='comma'>,</span>
              <span class='symbol'>:PS</span><span class='comma'>,</span>
              <span class='symbol'>:L</span><span class='comma'>,</span>
              <span class='symbol'>:LS</span><span class='comma'>,</span>
              <span class='symbol'>:B</span><span class='comma'>,</span>
              <span class='symbol'>:SP</span><span class='comma'>,</span>
              <span class='symbol'>:MC</span><span class='comma'>,</span>
              <span class='symbol'>:C</span><span class='comma'>,</span>
              <span class='symbol'>:F</span>
          <span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_groups_spec-rb-11"></a>
    Traffic Light Controller Signal Group is ordered to green with M0010
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that a signal group can be ordered to green using the M0010 command.</p>
<ol><li>
<p>Verify connection</p>
</li><li>
<p>Send control command to start signalgrup, set_signal_start= true, include security_code</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_groups_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_signal_start'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_signal_start-instance_method" title="Validator::CommandHelpers#set_signal_start (method)">set_signal_start</a></span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_groups_spec-rb-21"></a>
    Traffic Light Controller Signal Group is ordered to red with M0011
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      <ol><li>
<p>Verify connection</p>
</li><li>
<p>Send control command to stop signalgrup, set_signal_start= false, include security_code</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


21
22
23
24</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_groups_spec.rb', line 21</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_signal_stop'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_signal_stop-instance_method" title="Validator::CommandHelpers#set_signal_stop (method)">set_signal_stop</a></span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_groups_spec-rb-33"></a>
    Traffic Light Controller Signal Group state is read with S0001
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that signal group status can be read with S0001.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


33
34
35
36</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_groups_spec.rb', line 33</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>signal group status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0001:</span> <span class='lbracket'>[</span><span class='symbol'>:signalgroupstatus</span><span class='comma'>,</span> <span class='symbol'>:cyclecounter</span><span class='comma'>,</span> <span class='symbol'>:basecyclecounter</span><span class='comma'>,</span> <span class='symbol'>:stage</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_groups_spec-rb-45"></a>
    Traffic Light Controller Signal Group red/green predictions is read with S0025
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that time-of-green/time-of-red can be read with S0025.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_groups_spec.rb', line 45</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>time-of-green/time-of-red</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0025:</span> <span class='lbracket'>[</span>
              <span class='symbol'>:minToGEstimate</span><span class='comma'>,</span>
              <span class='symbol'>:maxToGEstimate</span><span class='comma'>,</span>
              <span class='symbol'>:likelyToGEstimate</span><span class='comma'>,</span>
              <span class='symbol'>:ToGConfidence</span><span class='comma'>,</span>
              <span class='symbol'>:minToREstimate</span><span class='comma'>,</span>
              <span class='symbol'>:maxToREstimate</span><span class='comma'>,</span>
              <span class='symbol'>:likelyToREstimate</span>
          <span class='rbracket'>]</span> <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>signal_group</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_groups_spec-rb-66"></a>
    Traffic Light Controller Signal Group list size is read with S0017
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0017 number of signal groups</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


66
67
68
69</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_groups_spec.rb', line 66</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>number of signal groups</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0017:</span> <span class='lbracket'>[</span><span class='symbol'>:number</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_groups_spec-rb-78"></a>
    Traffic Light Controller Signal Group follow startup sequence after yellow flash
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we can activate normal control after yellow flash mode is turned off</p>
<ol><li>
<p>Given the site is connected and in yellow flash mode</p>
</li><li>
<p>When we activate normal control</p>
</li><li>
<p>All signal groups should go through e, f and g</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


78
79
80
81
82
83
84
85</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_groups_spec.rb', line 78</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_verify_startup_sequence'><span class='object_link'><a href="../../Validator/CommandHelpers.html#verify_startup_sequence-instance_method" title="Validator::CommandHelpers#verify_startup_sequence (method)">verify_startup_sequence</a></span></span> <span class='kw'>do</span>
          <span class='id identifier rubyid_switch_yellow_flash'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_yellow_flash-instance_method" title="Validator::CommandHelpers#switch_yellow_flash (method)">switch_yellow_flash</a></span></span>
          <span class='id identifier rubyid_set_functional_position'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_functional_position-instance_method" title="Validator::CommandHelpers#set_functional_position (method)">set_functional_position</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NormalControl</span><span class='tstring_end'>&#39;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_set_functional_position'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_functional_position-instance_method" title="Validator::CommandHelpers#set_functional_position (method)">set_functional_position</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NormalControl</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-detector_logics_spec-rb-11"></a>
    Traffic Light Controller Detector Logic list size is read with S0016
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0016 number of detector logics</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/detector_logics_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>number of detector logics</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0016:</span> <span class='lbracket'>[</span><span class='symbol'>:number</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-detector_logics_spec-rb-23"></a>
    Traffic Light Controller Detector Logic status is read with S0002
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0002 detector logic status</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


23
24
25
26</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/detector_logics_spec.rb', line 23</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>detector logic status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0002:</span> <span class='lbracket'>[</span><span class='symbol'>:detectorlogicstatus</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-detector_logics_spec-rb-35"></a>
    Traffic Light Controller Detector Logic forcing is read with S0021
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0021 manually set detector logic</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


35
36
37
38</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/detector_logics_spec.rb', line 35</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>detector logic forcing</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0021:</span> <span class='lbracket'>[</span><span class='symbol'>:detectorlogics</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-detector_logics_spec-rb-45"></a>
    Traffic Light Controller Detector Logic forcing is set with M0008
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      <ol><li>
<p>Verify connection</p>
</li><li>
<p>Send control command to switch detector_logic= true</p>
</li><li>
<p>Wait for status = true</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/detector_logics_spec.rb', line 45</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>

        <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detector_logic</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='id identifier rubyid_indx'>indx</span><span class='op'>|</span>
          <span class='id identifier rubyid_force_detector_logic'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_detector_logic-instance_method" title="Validator::CommandHelpers#force_detector_logic (method)">force_detector_logic</a></span></span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='label'>mode:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span><span class='lparen'>(</span><span class='ivar'>@task</span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>detector logic </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component'>component</span><span class='embexpr_end'>}</span><span class='tstring_content'> to be True</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0002</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detectorlogicstatus</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^.{</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_indx'>indx</span><span class='embexpr_end'>}</span><span class='tstring_content'>}1</span><span class='regexp_end'>/</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
          <span class='rparen'>)</span>
          
          <span class='id identifier rubyid_force_detector_logic'><span class='object_link'><a href="../../Validator/CommandHelpers.html#force_detector_logic-instance_method" title="Validator::CommandHelpers#force_detector_logic (method)">force_detector_logic</a></span></span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span> <span class='label'>mode:</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span><span class='lparen'>(</span><span class='ivar'>@task</span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>detector logic </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_component'>component</span><span class='embexpr_end'>}</span><span class='tstring_content'> to be False</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0002</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>detectorlogicstatus</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>^.{</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_indx'>indx</span><span class='embexpr_end'>}</span><span class='tstring_content'>}0</span><span class='regexp_end'>/</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
          <span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-detector_logics_spec-rb-70"></a>
    Traffic Light Controller Detector Logic sensitivity is read with S0031
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0031 trigger level sensitivity for loop detector</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


70
71
72
73</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/detector_logics_spec.rb', line 70</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>loop detector sensitivity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0031:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_priority_spec-rb-13"></a>
    Traffic Light Controller Signal Priority can be requested with M0022
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that a signal priority can be requested.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we send a signal priority request</p>
</li><li>
<p>Then we should receive an acknowledgement</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_priority_spec.rb', line 13</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_signal_group'>signal_group</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>signal_group</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_command_list'>command_list</span> <span class='op'>=</span> <span class='id identifier rubyid_build_command_list'><span class='object_link'><a href="../../Validator/CommandHelpers.html#build_command_list-instance_method" title="Validator::CommandHelpers#build_command_list (method)">build_command_list</a></span></span> <span class='symbol'>:M0022</span><span class='comma'>,</span> <span class='symbol'>:requestPriority</span><span class='comma'>,</span> <span class='lbrace'>{</span>
          <span class='label'>requestId:</span> <span class='const'>SecureRandom</span><span class='period'>.</span><span class='id identifier rubyid_uuid'>uuid</span><span class='lparen'>(</span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>3</span><span class='rbracket'>]</span><span class='comma'>,</span>
          <span class='label'>signalGroupId:</span> <span class='id identifier rubyid_signal_group'>signal_group</span><span class='comma'>,</span>
          <span class='label'>type:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>new</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
          <span class='label'>level:</span> <span class='int'>7</span><span class='comma'>,</span>
          <span class='label'>eta:</span> <span class='int'>10</span><span class='comma'>,</span>
          <span class='label'>vehicleType:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>car</span><span class='tstring_end'>&#39;</span></span>
        <span class='rbrace'>}</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_send_command_and_confirm'><span class='object_link'><a href="../../Validator/CommandHelpers.html#send_command_and_confirm-instance_method" title="Validator::CommandHelpers#send_command_and_confirm (method)">send_command_and_confirm</a></span></span> <span class='ivar'>@task</span><span class='comma'>,</span> <span class='id identifier rubyid_command_list'>command_list</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Request signal priority for signal group </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_signal_group'>signal_group</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_priority_spec-rb-35"></a>
    Traffic Light Controller Signal Priority status can be fetched with S0033
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that signal priority status can be requested.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>When we request signal priority status</p>
</li><li>
<p>Then we should receive a status update</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


35
36
37
38</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_priority_spec.rb', line 35</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>signal group status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0033:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_priority_spec-rb-48"></a>
    Traffic Light Controller Signal Priority status can be subscribed to with S0033
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that we can subscribe signal priority status</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And we subscribe to signal priority status updates</p>
</li><li>
<p>Then we should receive an acknowledgement</p>
</li><li>
<p>And we should reive a status updates</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


48
49
50
51
52
53</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_priority_spec.rb', line 48</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0033</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>uRt</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_status_list'>status_list</span><span class='period'>.</span><span class='id identifier rubyid_map!'>map!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sOc</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id identifier rubyid_use_sOc?'><span class='object_link'><a href="../../Validator/StatusHelpers.html#use_sOc%3F-instance_method" title="Validator::StatusHelpers#use_sOc? (method)">use_sOc?</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_site'>site</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>signal priority status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_priority_spec-rb-67"></a>
    Traffic Light Controller Signal Priority becomes completed when cancelled
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that a signal priority completes when we cancel it.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And we subscribe to signal priority status</p>
</li><li>
<p>When we send a signal priority request</p>
</li><li>
<p>Then the request state should become ‘received’</p>
</li><li>
<p>Then the request state should become ‘activated’</p>
</li><li>
<p>When we cancel the request</p>
</li><li>
<p>Then the state should become ‘completed’</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_priority_spec.rb', line 67</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>priority_completion</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_component'>component</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_signal_group_id'>signal_group_id</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>signal_group</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_prio'>prio</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/StatusHelpers.html" title="Validator::StatusHelpers (module)">StatusHelpers</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/StatusHelpers/SignalPriorityRequestHelper.html" title="Validator::StatusHelpers::SignalPriorityRequestHelper (class)">SignalPriorityRequestHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Validator/StatusHelpers/SignalPriorityRequestHelper.html#initialize-instance_method" title="Validator::StatusHelpers::SignalPriorityRequestHelper#initialize (method)">new</a></span></span><span class='lparen'>(</span>
          <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span>
          <span class='label'>component:</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span>
          <span class='label'>signal_group_id:</span> <span class='id identifier rubyid_signal_group_id'>signal_group_id</span><span class='comma'>,</span>
          <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span>
          <span class='label'>task:</span> <span class='id identifier rubyid_task'>task</span>
        <span class='rparen'>)</span>

        <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_run'>run</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Before: Send unrelated signal priority request.</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_request_unrelated'>request_unrelated</span>

          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Send signal priority request, wait for reception.</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span>

          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>After: Send unrelated signal priority request.</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_request_unrelated'>request_unrelated</span>

          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_expect'>expect</span> <span class='symbol'>:received</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signal priority request was received, wait for activation.</span><span class='tstring_end'>&quot;</span></span>

          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_expect'>expect</span> <span class='symbol'>:activated</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signal priority request was activated, now cancel it and wait for completion.</span><span class='tstring_end'>&quot;</span></span>


          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_cancel'>cancel</span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_expect'>expect</span> <span class='symbol'>:completed</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signal priority request was completed.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-signal_priority_spec-rb-114"></a>
    Traffic Light Controller Signal Priority becomes stale if not cancelled
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Validate that a signal priority times out if not cancelled.</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>And we subscribe to signal priority status</p>
</li><li>
<p>When we send a signal priority request</p>
</li><li>
<p>Then the request state should become ‘received’</p>
</li><li>
<p>Then the request state should become ‘activated’</p>
</li><li>
<p>When we do not cancel the request</p>
</li><li>
<p>Then the state should become ‘stale’</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/signal_priority_spec.rb', line 114</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_timeout'>timeout</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>timeouts</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>priority_completion</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_component'>component</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main_component</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_signal_group_id'>signal_group_id</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>components</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>signal_group</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='id identifier rubyid_prio'>prio</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/StatusHelpers.html" title="Validator::StatusHelpers (module)">StatusHelpers</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/StatusHelpers/SignalPriorityRequestHelper.html" title="Validator::StatusHelpers::SignalPriorityRequestHelper (class)">SignalPriorityRequestHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../../Validator/StatusHelpers/SignalPriorityRequestHelper.html#initialize-instance_method" title="Validator::StatusHelpers::SignalPriorityRequestHelper#initialize (method)">new</a></span></span><span class='lparen'>(</span>
          <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span>
          <span class='label'>component:</span> <span class='id identifier rubyid_component'>component</span><span class='comma'>,</span>
          <span class='label'>signal_group_id:</span> <span class='id identifier rubyid_signal_group_id'>signal_group_id</span><span class='comma'>,</span>
          <span class='label'>timeout:</span> <span class='id identifier rubyid_timeout'>timeout</span><span class='comma'>,</span>
          <span class='label'>task:</span> <span class='id identifier rubyid_task'>task</span>
        <span class='rparen'>)</span>

        <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_run'>run</span> <span class='kw'>do</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Before: Send unrelated signal priority request.</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_request_unrelated'>request_unrelated</span>

          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Send signal priority request, wait for reception.</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_request'>request</span>

          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>After: Send unrelated signal priority request.</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_request_unrelated'>request_unrelated</span>

          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_expect'>expect</span> <span class='symbol'>:received</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signal priority request was received, wait for activation.</span><span class='tstring_end'>&quot;</span></span>

          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_expect'>expect</span> <span class='symbol'>:activated</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signal priority request was activated, wait for it to become stale.</span><span class='tstring_end'>&quot;</span></span>


          <span class='comment'># don&#39;t cancel request, it should then become stale by itself
</span>          <span class='id identifier rubyid_prio'>prio</span><span class='period'>.</span><span class='id identifier rubyid_expect'>expect</span> <span class='symbol'>:stale</span>
          <span class='id identifier rubyid_log'>log</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Signal priority request became stale.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-emergency_routes_spec-rb-12"></a>
    Traffic Light Controller Emergency Route emergency route is read with S0006
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that current emergency route can be read with S0006. Depreciated from 1.2, use S0035 instead.</p>
<ol><li>
<p>Given the site is connected.</p>
</li><li>
<p>When we request S0006.</p>
</li><li>
<p>Then we should receive a status response.</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


12
13
14
15</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/emergency_routes_spec.rb', line 12</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>emergency route status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0006:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:emergencystage</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-emergency_routes_spec-rb-24"></a>
    Traffic Light Controller Emergency Route emergency route is read with S0035
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that current emergency routes can be read with S0035. Requires core &gt;= 3.2 since it uses the array data type.</p>
<ol><li>
<p>Given the site is connected.</p>
</li><li>
<p>When we request S0035.</p>
</li><li>
<p>Then we should receive a status response.</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


24
25
26
27</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/emergency_routes_spec.rb', line 24</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>emergency route status</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0035:</span> <span class='lbracket'>[</span><span class='symbol'>:emergencyroutes</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-emergency_routes_spec-rb-36"></a>
    Traffic Light Controller Emergency Route can be activated with M0005 and read with S0006
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that emergency routes can be activated with M0005. S0006 should reflect the last route enabled/disabled.</p>
<ol><li>
<p>Given the site is connected.</p>
</li><li>
<p>When we send M0005 to set emergency route.</p>
</li><li>
<p>Then we should get a command responds confirming the change.</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/emergency_routes_spec.rb', line 36</span>

<span class='id identifier rubyid_emergency_routes'>emergency_routes</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>emergency_routes</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No emergency routes configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='kw'>def</span> <span class='id identifier rubyid_set_emergency_states'>set_emergency_states</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='comma'>,</span> <span class='id identifier rubyid_state'>state</span>
        <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_emergency_route'>emergency_route</span><span class='op'>|</span>
          <span class='id identifier rubyid_set_emergency_route'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_emergency_route-instance_method" title="Validator::CommandHelpers#set_emergency_route (method)">set_emergency_route</a></span></span> <span class='id identifier rubyid_emergency_route'>emergency_route</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='id identifier rubyid_state'>state</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>emergency route </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='embexpr_end'>}</span><span class='tstring_content'> to be enabled</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbracket'>[</span>
            <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0006</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>status</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>True</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>False</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span><span class='comma'>,</span>
            <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0006</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>emergencystage</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span> <span class='op'>?</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>0</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rbrace'>}</span>
          <span class='rbracket'>]</span>
        <span class='rparen'>)</span>
     <span class='kw'>end</span>

      <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_set_emergency_states'>set_emergency_states</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='comma'>,</span> <span class='kw'>false</span>
        <span class='kw'>begin</span>
          <span class='id identifier rubyid_set_emergency_states'>set_emergency_states</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='comma'>,</span> <span class='kw'>true</span>
        <span class='kw'>ensure</span>
          <span class='id identifier rubyid_set_emergency_states'>set_emergency_states</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='comma'>,</span> <span class='kw'>false</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-emergency_routes_spec-rb-71"></a>
    Traffic Light Controller Emergency Route emergency routes can be activated with M0005 and read with S0035
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that emergency routes can be activated with M0005. S0035 should show all active routes.</p>
<ol><li>
<p>Given the site is connected.</p>
</li><li>
<p>When we send M0005 to set emergency route.</p>
</li><li>
<p>Then we should get a command responds confirming the change.</p>
</li><li>
<p>When we request the current emergency routes with S035.</p>
</li><li>
<p>Then we should receive the list of active routes.</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/emergency_routes_spec.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enable_routes'>enable_routes</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span>
        <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_emergency_route'>emergency_route</span><span class='op'>|</span> <span class='id identifier rubyid_set_emergency_route'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_emergency_route-instance_method" title="Validator::CommandHelpers#set_emergency_route (method)">set_emergency_route</a></span></span> <span class='id identifier rubyid_emergency_route'>emergency_route</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_routes'>routes</span> <span class='op'>=</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>id</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='id identifier rubyid_i'>i</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbrace'>}</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>emergency routes </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_content'> to be enabled</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbracket'>[</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0035</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>emergencyroutes</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='id identifier rubyid_routes'>routes</span><span class='rbrace'>}</span> <span class='rbracket'>]</span>
        <span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='kw'>def</span> <span class='id identifier rubyid_disable_routes'>disable_routes</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span>
        <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_emergency_route'>emergency_route</span><span class='op'>|</span> <span class='id identifier rubyid_set_emergency_route'><span class='object_link'><a href="../../Validator/CommandHelpers.html#set_emergency_route-instance_method" title="Validator::CommandHelpers#set_emergency_route (method)">set_emergency_route</a></span></span> <span class='id identifier rubyid_emergency_route'>emergency_route</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='kw'>false</span> <span class='rbrace'>}</span>
        <span class='id identifier rubyid_routes'>routes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_wait_for_status'><span class='object_link'><a href="../../Validator/StatusHelpers.html#wait_for_status-instance_method" title="Validator::StatusHelpers#wait_for_status (method)">wait_for_status</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>all emergency routes to be disabled</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbracket'>[</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sCI</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>S0035</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>n</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>emergencyroutes</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>s</span><span class='tstring_end'>&#39;</span></span><span class='op'>=&gt;</span><span class='id identifier rubyid_routes'>routes</span><span class='rbrace'>}</span> <span class='rbracket'>]</span>
        <span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_emergency_routes'>emergency_routes</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>emergency_routes</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

      <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No emergency routes configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

      <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_disable_routes'>disable_routes</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span>
        <span class='kw'>begin</span>
          <span class='id identifier rubyid_enable_routes'>enable_routes</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span>
        <span class='kw'>ensure</span>
          <span class='id identifier rubyid_disable_routes'>disable_routes</span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_emergency_routes'>emergency_routes</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
    
    
    
    
    <li><div class='context'>
  <h1 class='title'>
  
    
  

  </h1>

  <ul class='context-specifications'>
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_situations_spec-rb-11"></a>
    Traffic Light Controller Traffic Situation is read with S0015
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0015 current traffic situation</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


11
12
13
14
15
16
17
18</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_situations_spec.rb', line 11</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='const'>RSMP</span><span class='op'>::</span><span class='const'>Proxy</span><span class='period'>.</span><span class='id identifier rubyid_version_meets_requirement?'>version_meets_requirement?</span><span class='lparen'>(</span> <span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_sxl_version'>sxl_version</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;=1.1</span><span class='tstring_end'>&#39;</span></span> <span class='rparen'>)</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0015:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='comma'>,</span><span class='symbol'>:source</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_status_list'>status_list</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>S0015:</span> <span class='lbracket'>[</span><span class='symbol'>:status</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>current traffic situation</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_status_list'>status_list</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_situations_spec-rb-28"></a>
    Traffic Light Controller Traffic Situation is set with M0003
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify that we change traffic situation</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Verify that there is a Validator.get_config(‘validator’) with a traffic situation</p>
</li><li>
<p>Send the control command to switch traffic situation for each traffic situation</p>
</li><li>
<p>Wait for status “Current traffic situation” = requested traffic situation</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


28
29
30
31
32
33
34
35</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_situations_spec.rb', line 28</span>

<span class='id identifier rubyid_situations'>situations</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_config'>get_config</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>items</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>traffic_situations</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_skip'>skip</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>No traffic situations configured</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_situations'>situations</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_situations'>situations</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_prepare'><span class='object_link'><a href="../../Validator/CommandHelpers.html#prepare-instance_method" title="Validator::CommandHelpers#prepare (method)">prepare</a></span></span> <span class='id identifier rubyid_task'>task</span><span class='comma'>,</span> <span class='id identifier rubyid_site'>site</span>
        <span class='id identifier rubyid_situations'>situations</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_traffic_situation'>traffic_situation</span><span class='op'>|</span> <span class='id identifier rubyid_switch_traffic_situation'><span class='object_link'><a href="../../Validator/CommandHelpers.html#switch_traffic_situation-instance_method" title="Validator::CommandHelpers#switch_traffic_situation (method)">switch_traffic_situation</a></span></span> <span class='id identifier rubyid_traffic_situation'>traffic_situation</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span>
      <span class='kw'>ensure</span>
        <span class='id identifier rubyid_unset_traffic_situation'><span class='object_link'><a href="../../Validator/CommandHelpers.html#unset_traffic_situation-instance_method" title="Validator::CommandHelpers#unset_traffic_situation (method)">unset_traffic_situation</a></span></span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
      
      <li class='context-specification'><div class="specification">
  <div class="heading ">
    <a name="spec-site-tlc-traffic_situations_spec-rb-44"></a>
    Traffic Light Controller Traffic Situation list size is read with S0019
  </div>

  <div class="details method_details_list">
    
    <div class="docstring">
      
<p>Verify status S0019 number of traffic situations</p>
<ol><li>
<p>Given the site is connected</p>
</li><li>
<p>Request status</p>
</li><li>
<p>Expect status response before timeout</p>
</li></ol>

    </div>

    <div style="clear: both;"></div>

    <!-- Source Code -->
    <div style="float: left;">
      <table class="source_code">
        <tr>
          <td>
            <pre class="lines">


44
45
46
47</pre>
          </td>
          <td>
            <pre class="code"><span class="info file"># File 'spec/site/tlc/traffic_situations_spec.rb', line 44</span>

<span class='const'><span class='object_link'><a href="../../Validator.html" title="Validator (module)">Validator</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Validator/Site.html" title="Validator::Site (class)">Site</a></span></span><span class='period'>.</span><span class='id identifier rubyid_connected'><span class='object_link'><a href="../../Validator/Site.html#connected-class_method" title="Validator::Site.connected (method)">connected</a></span></span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_task'>task</span><span class='comma'>,</span><span class='id identifier rubyid_supervisor'>supervisor</span><span class='comma'>,</span><span class='id identifier rubyid_site'>site</span><span class='op'>|</span>
        <span class='id identifier rubyid_request_status_and_confirm'><span class='object_link'><a href="../../Validator/StatusHelpers.html#request_status_and_confirm-instance_method" title="Validator::StatusHelpers#request_status_and_confirm (method)">request_status_and_confirm</a></span></span> <span class='id identifier rubyid_site'>site</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>number of traffic situations</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='lbrace'>{</span> <span class='label'>S0019:</span> <span class='lbracket'>[</span><span class='symbol'>:number</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
      <span class='kw'>end</span></pre>
          </td>
        </tr>
      </table>
    </div>
    

    <div style="clear: both;"></div>
    
  </div>

  <!-- Captures the collapsed state -->
  <div class="attributes" style="display:none;">
    <input type="hidden" name="collapsed" value="false">
  </div>

</div></li> 
    
  </ul>
  
  <ul class='context-subcontext'>
  
  
  </ul>

</div></li>
    

    
  
  </ul>

</div></div>

      <div id="footer">
Maintained by <a href="https://rsmp-nordic.org" title="RSMP Nordic" target="_parent">RSMP Nordic</a>
</div>
    </div>
  </body>
</html>